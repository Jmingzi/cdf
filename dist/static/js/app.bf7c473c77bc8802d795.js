webpackJsonp([1],{"+27K":function(e,t){},"+BTi":function(e,t){},"+Rdb":function(e,t){},"/I4U":function(e,t){},"/JAP":function(e,t,s){"use strict";var r=s("//Fk"),i=s.n(r),a=(s("7+uW"),s("mtWM")),n=s.n(a),l=s("mw3O"),o=s.n(l),c=n.a.create({baseURL:"http://oa.ixunle.com",timeout:1e4,withCredentials:!0,paramsSerializer:function(e){return o.a.stringify(e,{arrayFormat:"brackets"})}});c.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",c.interceptors.request.use(function(e){return e},function(e){return i.a.reject(e)});var u=[200,601];c.interceptors.response.use(function(e){return u.includes(e.data.code)?e.data:i.a.reject(e)},function(e){return i.a.reject(e)});var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d(e,t)},d=function(e){var t,s,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.mock&&(s=(t=e).lastIndexOf("/"),e="./static"+t.substr(s,t.length)+".json"),c.post(e,r)};t.a={url:{login:"/service/logic/controller/IndexController.php?act=user&met=login",getDept:"/service/logic/controller/IndexController.php?act=dept&met=depts",getUserByDeptId:"/service/logic/controller/IndexController.php?act=dept&met=getUserById",getAnnous:"/service/logic/controller/IndexController.php?act=notice&met=notices",addAnnous:"/service/logic/controller/IndexController.php?act=notice&met=add",editAnnous:"/service/logic/controller/IndexController.php?act=notice&met=edit",getPrivList:"/service/logic/controller/IndexController.php?act=priv&met=privs",addPriv:"/service/logic/controller/IndexController.php?act=priv&met=add",editPriv:"/service/logic/controller/IndexController.php?act=priv&met=edit",jobList:"/service/logic/controller/IndexController.php?act=job&met=getJobs",addJob:"/service/logic/controller/IndexController.php?act=job&met=add",addUserToJob:"/service/logic/controller/IndexController.php?act=job&met=addUser",delJobUser:"/service/logic/controller/IndexController.php?act=job&met=delUser",getProcess:"/service/logic/controller/IndexController.php?act=process&met=getProcess",applyExpense:"/service/logic/controller/IndexController.php?act=expense&met=apply",getInfos:"/service/logic/controller/IndexController.php?act=user&met=getInfo",getSetting:"/service/logic/controller/IndexController.php?act=process&met=getSetting",addProcess:"/ service/logic/controller/IndexController.php?act=process&met=save",delProcess:"/service/logic/controller/IndexController.php?act=process&met=del",getExpenseList:"/service/logic/controller/IndexController.php?act=expense&met=getExpenses",saveUser:"/service/logic/controller/IndexController.php?act=user&met=save",saveDeptUri:"/service/logic/controller/IndexController.php?act=dept&met=add",handleProcessStatus:"/service/logic/controller/IndexController.php?act=expense&met=handle",handleSpreadStatus:"/service/logic/controller/IndexController.php?act=spread&met=handle",delPriv:"/service/logic/controller/IndexController.php?act=priv&met=del",optAnnous:"/service/logic/controller/IndexController.php?act=notice&met=opt",expenseDetail:"/service/logic/controller/IndexController.php?act=expense&met=getById",delJob:"/service/logic/controller/IndexController.php?act=job&met=del",applySpreadExpense:"/service/logic/controller/IndexController.php?act=spread&met=apply",addSpreadExpenseDetail:"/service/logic/controller/IndexController.php?act=spread&met=addItem",getSpreadExpenseList:"/service/logic/controller/IndexController.php?act=spread&met=getExpenses",getSpreadDetail:"/service/logic/controller/IndexController.php?act=spread&met=getById",updatePwd:"/service/logic/controller/IndexController.php?act=user&met=updatePass",logOut:"/service/logic/controller/IndexController.php?act=user&met=logout"},login:function(e){return p(this.url.login,e)},getDept:function(e){return p(this.url.getDept,e)},getUserByDeptId:function(e){return p(this.url.getUserByDeptId,e)},getAnnous:function(e){return p(this.url.getAnnous,e)},addAnnous:function(e){return p(this.url.addAnnous,e)},editAnnous:function(e){return p(this.url.editAnnous,e)},getPrivList:function(e){return p(this.url.getPrivList,e)},addPriv:function(e){return p(this.url.addPriv,e)},editPriv:function(e){return p(this.url.editPriv,e)},jobList:function(){return p(this.url.jobList)},addJob:function(e){return p(this.url.addJob,e)},addUserToJob:function(e){return p(this.url.addUserToJob,e)},delJobUser:function(e){return p(this.url.delJobUser,e)},getProcess:function(e){return p(this.url.getProcess,e)},applyExpense:function(e){return p(this.url.applyExpense,e)},getInfos:function(e){return p(this.url.getInfos,e)},getSetting:function(e){return p(this.url.getSetting,e)},addProcess:function(e){return p(this.url.addProcess,e)},delProcess:function(e){return p(this.url.delProcess,e)},getExpenseList:function(e){return p(this.url.getExpenseList,e)},saveUser:function(e){return p(this.url.saveUser,e)},saveDept:function(e){return p(this.url.saveDeptUri,e)},handleProcessStatus:function(e){return p(this.url.handleProcessStatus,e)},delPriv:function(e){return p(this.url.delPriv,e)},optAnnous:function(e){return p(this.url.optAnnous,e)},getExpenseDetail:function(e){return p(this.url.expenseDetail,e)},delJob:function(e){return p(this.url.delJob,e)},applySpreadExpense:function(e){return p(this.url.applySpreadExpense,e)},addSpreadExpenseDetail:function(e){return p(this.url.addSpreadExpenseDetail,e)},getSpreadExpenseList:function(e){return p(this.url.getSpreadExpenseList,e)},getSpreadDetail:function(e){return p(this.url.getSpreadDetail,e)},handleSpreadStatus:function(e){return p(this.url.handleSpreadStatus,e)},updatePwd:function(e){return p(this.url.updatePwd,e)},logOut:function(){return p(this.url.logOut)}}},"2rGO":function(e,t){},"3Zcx":function(e,t){},"4aj8":function(e,t,s){"use strict";var r=s("//Fk"),i=s.n(r),a=s("/JAP");t.a={data:function(){return{}},filters:{formatDeptUser:function(e){var t=e.dept.map(function(e){return e.label.replace(" ("+e.userNum+")","")}).join("、"),s=e.user.map(function(e){return e.name}).join("、");return t+(t?"、":"")+s}},methods:{http:function(e,t){var s=this,r=this.$loading({text:"加载中",background:"rgba(0, 0, 0, 0.8)"});return new i.a(function(i,n){a.a[e](t).then(function(e){r.close(),200===e.code?i(e.data):601===e.code?s.$router.push("/login"):(s.$message(error.msg),n(e))}).catch(function(e){r.close(),s.$message.error(e.data.msg||"net work error"),n(e)})})}}}},"5ObC":function(e,t){},"7Otq":function(e,t,s){e.exports=s.p+"static/img/logo.0cf34f9.png"},"7jEl":function(e,t){},"8jhb":function(e,t){},"8mNY":function(e,t){},AAlG:function(e,t){},BNJR:function(e,t){},BTcN:function(e,t){},CKqx:function(e,t){},DSCY:function(e,t){},Df1Z:function(e,t){},Dte2:function(e,t){},FA5p:function(e,t){},GXEp:function(e,t){},HR9g:function(e,t,s){"use strict";s.d(t,"h",function(){return r}),s.d(t,"g",function(){return i}),s.d(t,"b",function(){return a}),s.d(t,"c",function(){return n}),s.d(t,"d",function(){return l}),s.d(t,"e",function(){return o}),s.d(t,"f",function(){return c}),s.d(t,"a",function(){return u});var r=[{title:"首页",id:0,icon:"el-icon-menu",componentName:"Home"},{title:"组织架构",id:1,icon:"el-icon-star-off",componentName:"DeptUser"},{title:"岗位管理",id:5,icon:"el-icon-document",componentName:"Job"},{title:"公告管理",id:2,icon:"el-icon-bell",componentName:"Annous"},{title:"常规报销",id:3,icon:"el-icon-printer",componentName:"MoneySystem"},{title:"推广报销",id:6,icon:"el-icon-rank",componentName:"SpreadExpense"},{title:"权限设置",id:4,icon:"el-icon-setting",componentName:"Priv"}],i=[{title:"操作员工",id:0,componentName:"user"},{title:"操作部门",id:1,componentName:"dept"},{title:"操作流程",id:3,componentName:"process"},{title:"新建公告",id:4,componentName:"annous"},{title:"操作岗位",id:5,componentName:"job"},{title:"普通报销统计",id:6,componentName:"expense"},{title:"推广报销统计",id:7,componentName:"spreadExpense"}],a=[{label:"办公室支出",value:"1",children:[{label:"办公室耗材",value:"1"},{label:"通讯费用（话费、手机卡等）",value:"2"},{label:"水电",value:"3"},{label:"房租",value:"4"},{label:"文化建设（装修、绿植、文化宣传）",value:"5"},{label:"固定资产（桌椅、冰箱、微波炉等）",value:"6"}]},{label:"人事支出",value:"2",children:[{label:"工资",value:"1"},{label:"奖金",value:"2"},{label:"招聘",value:"3"},{label:"员工福利",value:"4"},{label:"差旅费",value:"5"},{label:"文化活动",value:"6"}]},{label:"技术支出",value:"3",children:[{label:"第三方平台使用费",value:"1"},{label:"插件开发",value:"2"},{label:"技术外包",value:"3"}]},{label:"宿舍支出",value:"4",children:[{label:"房租",value:"1"},{label:"水电",value:"2"},{label:"固定资产（如床位、洗衣机）",value:"3"}]},{label:"硬件设备",value:"5",children:[{label:"电脑",value:"1"},{label:"手机",value:"2"},{label:"路由器",value:"3"},{label:"交换机",value:"4"},{label:"摄像头",value:"5"},{label:"打印机",value:"6"},{label:"投影仪",value:"7"},{label:"显示器",value:"8"},{label:"其他",value:"9"}]},{label:"仓储支出",value:"6",children:[{label:"退换货",value:"1"},{label:"运输费",value:"2"},{label:"包装耗材",value:"3"},{label:"产品进货",value:"4"}]},{label:"品牌建设",value:"7",children:[{label:"包装设计（设计、包材、修图等）",value:"1"},{label:"SEO推广费",value:"2"},{label:"宣传推广费（宣传册、横幅等）",value:"3"}]}],n=[{label:"支付宝",value:"1"},{label:"微信",value:"2"},{label:"银行转账",value:"3"},{label:"现金",value:"4"}],l=[{label:"普通报销",value:1},{label:"推广报销",value:2}],o=[{label:"360",value:1},{label:"百度",value:2},{label:"搜狗",value:3}],c=[{label:"延时",value:1},{label:"私护",value:2},{label:"红血丝",value:3}],u=[{label:"发起申请",value:"1",color:"color-success",icon:"el-icon-circle-check"},{label:"审批中",value:"2",color:"color-warning",icon:"el-icon-remove"},{label:"已通过",value:"3",color:"color-success",icon:"el-icon-circle-check"},{label:"已拒绝",value:"4",color:"color-red",icon:"el-icon-error"},{label:"待打款",value:"5",color:"color-ccc",icon:"el-icon-remove"},{label:"已完成",value:"6",color:"color-success",icon:"el-icon-circle-check"},{label:"待审批",value:"7",color:"color-ccc",icon:"el-icon-circle-remove"},{label:"已撤回",value:"8",color:"color-ccc",icon:"el-icon-circle-remove"}]},I4nB:function(e,t){},IxJZ:function(e,t){},MLwL:function(e,t){},Mrsn:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});s("cwe7"),s("+BTi");var r=s("2X9z"),i=s.n(r),a=(s("/I4U"),s("yg6k")),n=s.n(a),l=(s("oq7i"),s("+TD8")),o=s.n(l),c=(s("2rGO"),s("nu7/")),u=s.n(c),p=(s("ylrw"),s("6oiW")),d=s.n(p),m=(s("Dte2"),s("q4le")),f=s.n(m),v=(s("isE6"),s("LR6y")),h=s.n(v),_=(s("s967"),s("855/")),b=s.n(_),g=(s("BNJR"),s("fDPO")),x=s.n(g),C=(s("isgN"),s("tLa+")),y=s.n(C),w=(s("jZDA"),s("91Nw")),D=s.n(w),k=(s("5ObC"),s("4ZDJ")),T=s.n(k),U=(s("WzZF"),s("wxbk")),I=s.n(U),P=(s("TFIm"),s("s3ue")),S=s.n(P),$=(s("dmRH"),s("EKTV")),j=s.n($),E=(s("I4nB"),s("STLj")),N=s.n(E),A=(s("d7TW"),s("ajQY")),O=s.n(A),M=(s("8jhb"),s("RDoK")),L=s.n(M),F=(s("Zki6"),s("0kY3")),B=s.n(F),R=(s("X+ky"),s("HJMx")),z=s.n(R),q=(s("+Rdb"),s("Mezo")),V=s.n(q),J=(s("cDSy"),s("e0Bm")),W=s.n(J),K=(s("DSCY"),s("LaeV")),H=s.n(K),Q=(s("IxJZ"),s("NoPp")),Z=s.n(Q),Y=(s("Yq4J"),s("qubY")),G=s.n(Y),X=(s("XPMo"),s("uEG6")),ee=s.n(X),te=(s("8mNY"),s("YnkO")),se=s.n(te),re=(s("qunJ"),s("vqwl")),ie=s.n(re),ae=(s("jAzQ"),s("wOhx")),ne=s.n(ae),le=(s("GXEp"),s("mtrD")),oe=s.n(le),ce=(s("Rh7U"),s("pkKZ")),ue=s.n(ce),pe=(s("Q6SQ"),s("LQMI")),de=s.n(pe),me=(s("Df1Z"),s("D3wm")),fe=s.n(me),ve=s("7+uW"),he={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var _e=s("VU/8")({name:"App"},he,!1,function(e){s("oIBD")},null,null).exports,be=s("/ocq"),ge=s("Dd8w"),xe=s.n(ge),Ce=s("NYxO"),ye=s("HR9g"),we=s("lbHh"),De=s.n(we),ke=s("AJcs"),Te=s.n(ke),Ue=s("4aj8"),Ie={data:function(){return{showUpPwd:!1,form:{pwd:"",oPwd:""},rules:{oPwd:[{required:!0,message:"请输入原密码",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],pwd:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}]}}},mixins:[Ue.a],watch:{currentMenuId:function(e,t){return this.$emit("menuChange",e),e}},computed:xe()({},Object(Ce.e)(["currMenuId","userInfo"]),{currentMenuId:function(){var e=this.$route.query.menuId;return e?Number(e):this.currMenuId},privMenu:function(){if(this.userInfo){var e=this.userInfo.menuPriv;return ye.h.filter(function(t){return e.includes(t.id)})}return[]}}),methods:xe()({},Object(Ce.d)(["setState","clear"]),{setMenu:function(e){this.setState({key:"currMenuId",value:e.id}),this.$router.replace("/?menuId="+e.id)},logOut:function(){var e=this;this.http("logOut").then(function(){De.a.remove("_token"),e.clear(),e.$router.push("/login")})},submitForm:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form";this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.http("updatePwd",{pwd:Te()(e.form.pwd),oPwd:Te()(e.form.oPwd),userId:e.userInfo.userId}).then(function(){e.$message.success("修改密码成功"),e.logOut()})})}})},Pe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wrap-common position-a top-0 bottom-0 width-100 bg-f2"},[s("div",{staticClass:"header px-line-50 px-height-50 bg-fff"},[e._m(0),e._v(" "),s("div",{staticClass:"right position-a top-0 height-100 right-0 text-right"},[s("div",{staticClass:"ib-middle top-hover px-padding-lr20 cursor-p",on:{click:function(t){e.showUpPwd=!0}}},[s("span",[e._v("修改密码")])]),e._v(" "),s("div",{staticClass:"ib-middle top-hover px-padding-lr20 cursor-p",on:{click:e.logOut}},[s("span",[e._v("退出登录")])])])]),e._v(" "),s("div",{staticClass:"left-aside position-a px-top-50 bottom-0"},[e.userInfo?s("div",{staticClass:"user color-fff cl px-padding-15"},[s("img",{staticClass:"px-width-50 px-height-50 avatar fl",attrs:{src:"http://oa.ixunle.com/upload/icon/"+e.userInfo.avatarUrl}}),e._v(" "),s("p",{staticClass:"px-margin-t5"},[e._v(e._s(e.userInfo.name))]),e._v(" "),s("p",{staticClass:"px-font-12 color-aaa"},[e._v(e._s(e.userInfo.dept.name))])]):e._e(),e._v(" "),s("ul",{staticClass:"color-fff"},e._l(e.privMenu,function(t){return s("li",{key:t.id,class:"px-line-45 px-padding-lr15 cursor-p "+(e.currentMenuId===t.id?"active":""),on:{click:function(s){e.setMenu(t)}}},[s("i",{class:t.icon+" color-aaa"}),e._v(" "),s("i",{staticClass:"el-icon-caret-right fr px-margin-t15 color-aaa"}),e._v(" "),s("span",[e._v(e._s(t.title))])])}))]),e._v(" "),s("div",{staticClass:"right-aside position-a right-0 px-top-50 bottom-0 px-padding-15"},[e._t("default")],2),e._v(" "),s("el-dialog",{attrs:{width:"400px",title:"修改密码",visible:e.showUpPwd},on:{"update:visible":function(t){e.showUpPwd=t}}},[s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"0px"}},[s("el-form-item",{attrs:{label:"",prop:"oPwd"}},[s("el-input",{attrs:{clearable:"",placeholder:"请输入原密码"},model:{value:e.form.oPwd,callback:function(t){e.$set(e.form,"oPwd",t)},expression:"form.oPwd"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"",prop:"pwd"}},[s("el-input",{attrs:{clearable:"",placeholder:"请输入新密码"},model:{value:e.form.pwd,callback:function(t){e.$set(e.form,"pwd",t)},expression:"form.pwd"}})],1),e._v(" "),s("el-form-item",{staticClass:"text-center"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm()}}},[e._v("确认修改")])],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"left position-a left-0 top-0 height-100"},[t("p",{staticClass:"px-font-20 color-fff text-center"},[this._v("相源科技管理后台")])])}]};var Se=s("VU/8")(Ie,Pe,!1,function(e){s("bFZ2")},null,null).exports,$e={created:function(){this.notice()},watch:{userInfo:function(e){return e&&this.notice(),e}},computed:xe()({},Object(Ce.e)(["userInfo"])),methods:{notice:function(){this.userInfo&&-1===this.userInfo.is_update&&this.$msgbox.alert("当前密码不安全，建议修改密码")}}},je={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"home"},[t("div",[this._v("home")])])}]},Ee=s("VU/8")($e,je,!1,null,null,null).exports,Ne=s("/JAP"),Ae={name:"add-annous",data:function(){return{form:{title:"",annousReceiveDept:[],annousReceiveUser:[],annousContent:""},rules:{title:[{required:!0,message:"请输入公告标题",trigger:"blur"},{min:1,max:200,message:"长度在 1 到 200 个字符",trigger:"blur"}],annousContent:[{required:!0,message:"请输入公告内容",trigger:"blur"}]}}},filters:{getLabel:function(e){return e.label.replace(" ("+e.userNum+")","")}},mixins:[Ue.a],methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.add(t.form)})},add:function(e){var t=this;console.log(e),this.http(e.id?"editAnnous":"addAnnous",e).then(function(){t.$message({message:"添加成功",type:"success"})})},selectObj:function(){this.$refs.selectTree.show()},confirmSelect:function(e,t){this.form.annousReceiveDept=e,this.form.annousReceiveUser=t}}},Oe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"add-annous"},[s("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"公告标题",prop:"title"}},[s("el-input",{attrs:{placeholder:"请输入公告标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"接收对象"}},[s("div",{staticClass:"ib-middle cursor-p",on:{click:e.selectObj}},[0===e.form.annousReceiveDept.length&&0===e.form.annousReceiveUser.length?s("span",{staticClass:"color-info"},[e._v("全体员工")]):s("div",{staticClass:"color-info"},[e._l(e.form.annousReceiveDept,function(t,r){return s("span",[e._v("\n            "+e._s(e._f("getLabel")(t))+e._s(r!==e.form.annousReceiveDept.length-1||e.form.annousReceiveUser.length>0?"、":"")+"\n          ")])}),e._v(" "),e._l(e.form.annousReceiveUser,function(t,r){return e.form.annousReceiveUser.length>0?s("span",[e._v("\n            "+e._s(t.name)+e._s(r!==e.form.annousReceiveUser.length-1?"、":"")+"\n          ")]):e._e()})],2)])]),e._v(" "),s("el-form-item",{attrs:{label:"公告内容",prop:"annousContent"}},[s("el-input",{attrs:{type:"textarea",placeholder:"请输入公告内容"},model:{value:e.form.annousContent,callback:function(t){e.$set(e.form,"annousContent",t)},expression:"form.annousContent"}})],1),e._v(" "),s("div",{staticClass:"text-center"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("立即发布")])],1)],1),e._v(" "),s("select-tree",{ref:"selectTree",attrs:{selectedDept:e.form.annousReceiveDept,selectedUser:e.form.annousReceiveUser},on:{confirm:e.confirmSelect}})],1)},staticRenderFns:[]};var Me={components:{AddAnnous:s("VU/8")(Ae,Oe,!1,function(e){s("oQIp")},"data-v-4bf45455",null).exports},name:"annous",mixins:[Ue.a],data:function(){return{list:[],toMeList:[],fromMeList:[],currentDetail:null,currentTab:1,showAddPanel:!1}},created:function(){this.getList()},filters:{formatReceiveUser:function(e){return e.map(function(e){return e?e.name:""}).join("、")}},computed:xe()({},Object(Ce.c)(["otherPriv"]),{dataList:function(){return 1===this.currentTab?this.fromMeList:this.toMeList}}),methods:{getList:function(){var e=this;this.http("getAnnous",{currentPage:1,pageSize:100}).then(function(t){e.toMeList=t.reclist,e.fromMeList=t.publist})},lookDetail:function(e){this.currentDetail=e},closeDetailPanel:function(){this.currentDetail=null,this.showAddPanel=!1},optAnnous:function(e,t,s){var r=this,i=["撤回","发布","删除"];this.$msgbox.confirm("确定要"+i[s]+"该条公告吗").then(function(){r.http("optAnnous",{id:e.nid,status:s}).then(function(){r.$message.success(i[s]+"成功");var e=r[1===r.currentTab?"fromMeList":"toMeList"];2===s?e.splice(t,1):r.$set(e,t,xe()({},e[t],{status:0}))})})},changeTab:function(e){this.currentTab=e},addAnnous:function(){this.currentDetail=null,this.showAddPanel=!0}}},Le={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"annous width-100 height-100 bg-fff position-r"},[s("div",{staticClass:"px-line-50 color-c666 bd-gray-lighter-b"},[s("div",{class:"px-width-100 text-center px-font-16 ib-middle cursor-p "+(1===e.currentTab?"annous__tab-curr":""),on:{click:function(t){e.changeTab(1)}}},[e._v("我发出的")]),e._v(" "),s("div",{class:"px-width-100 text-center px-font-16 ib-middle cursor-p "+(2===e.currentTab?"annous__tab-curr":""),on:{click:function(t){e.changeTab(2)}}},[e._v("我收到的")]),e._v(" "),e.otherPriv.annous?s("div",{staticClass:"fr px-margin-r20"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.addAnnous()}}},[e._v("新建公告")])],1):e._e()]),e._v(" "),s("div",{staticClass:"position-a px-top-50 bottom-0 width-100 overflow-a px-padding-lr10"},[s("el-row",{attrs:{gutter:20}},[e._l(e.dataList,function(t,r){return s("el-col",{key:t.id,attrs:{span:12}},[0===t.status&&2===e.currentTab?[s("p",{staticClass:"text-center px-padding-tb49"},[e._v("该公告已撤回")])]:[s("el-card",{staticClass:"box-card px-margin-t20"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("p",[e._v(e._s(t.title))])]),e._v(" "),s("div",{staticClass:"px-font-12 color-c999"},[s("p",[s("span",[e._v("发布者：")]),e._v(" "),s("span",[e._v(e._s(t.pubUser.name))])]),e._v(" "),s("p",[s("span",[e._v("发布时间：")]),e._v(" "),s("span",[e._v(e._s(e.$utils.formatTime(t.pubTime)))])]),e._v(" "),s("p",[s("span",[e._v("接收人：")]),e._v(" "),s("span",[e._v(e._s(e._f("formatReceiveUser")(t.receiveUser)))])]),e._v(" "),s("p",{staticClass:"annous__item-content"},[s("span",[e._v("公告内容：")]),e._v(" "),s("span",{staticClass:"color-c666"},[e._v(e._s(t.content))])])]),e._v(" "),s("div",{staticClass:"px-padding-t10 text-right"},[s("el-button",{attrs:{size:"mini"},on:{click:function(s){e.lookDetail(t)}}},[e._v("查看详情")]),e._v(" "),1===e.currentTab?[1===t.status?s("el-button",{attrs:{size:"mini"},on:{click:function(s){e.optAnnous(t,r,0)}}},[e._v("撤回")]):s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){e.optAnnous(t,r,1)}}},[e._v("发布")]),e._v(" "),s("el-button",{attrs:{size:"mini"},on:{click:function(s){e.optAnnous(t,r,2)}}},[e._v("删除")])]:e._e()],2)])]],2)}),e._v(" "),0===e.dataList.length?s("el-col",{attrs:{span:24}},[s("div",{staticClass:"text-center color-c999 px-padding-t100"},[s("i",{staticClass:"el-icon-bell",staticStyle:{"font-size":"40px"}}),e._v(" "),s("p",{staticClass:"px-padding-t20"},[e._v("暂无公告~")])])]):e._e()],2)],1),e._v(" "),e.currentDetail||e.showAddPanel?s("div",{staticClass:"annous__detail-panel position-f top-0 bottom-0 right-0 bg-fff bd-ccc-l"},[s("div",{staticClass:"annous__detail-title px-line-40 bg-f2 text-center position-r"},[s("div",{staticClass:"position-a height-100 px-width-40 cursor-p",on:{click:e.closeDetailPanel}},[s("i",{staticClass:"el-icon-close"})]),e._v(" "),s("span",[e._v(e._s(e.currentDetail?"公告详情":"新建公告"))])]),e._v(" "),s("div",{staticClass:"position-a px-top-40 bottom-0 width-100 overflow-a px-padding-10"},[e.showAddPanel?[s("add-annous")]:1===e.currentTab||2===e.currentTab&&1===e.currentDetail.status?[s("p",{staticClass:"px-font-24"},[e._v(e._s(e.currentDetail.title))]),e._v(" "),s("p",{staticClass:"color-c999"},[s("span",{staticClass:"ib-middle"},[e._v("发布者："+e._s(e.currentDetail.pubUser?e.currentDetail.pubUser.name:""))]),e._v(" "),s("span",{staticClass:"ib-middle px-margin-l20"},[e._v("发布时间："+e._s(e.$utils.formatTime(e.currentDetail.pubTime)))]),e._v(" "),s("span",{staticClass:"ib-middle px-margin-l20"},[e._v("接收人："+e._s(e._f("formatReceiveUser")(e.currentDetail.receiveUser)))])]),e._v(" "),s("div",{staticClass:"px-padding-tb10 bd-gray-lighter-t px-margin-t10"},[e._v("\n          "+e._s(e.currentDetail.content)+"\n        ")])]:[e._m(0)]],2)]):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"annous__detail-ych"},[t("i",{staticClass:"el-icon-news"}),this._v(" "),t("p",[this._v("发布者已撤回该公告")])])}]};var Fe=s("VU/8")(Me,Le,!1,function(e){s("dWxa")},null,null).exports,Be=s("bOdI"),Re=s.n(Be),ze={mixins:[Ue.a],computed:xe()({},Object(Ce.e)(["dept","currentDept"])),mounted:function(){},props:{isNeedUser:{type:Boolean,default:!0}},filters:{getLabel:function(e){return e.label.replace(" ("+e.userNum+")","")}},methods:xe()({},Object(Ce.d)(["setState"]),{initDept:function(){var e=this;this.dept?this.getDeptCallback(this.dept):this.http("getDept").then(function(t){t=function e(t){t.forEach(function(s,r){t[r]=xe()({},s,{label:s.label+" ("+s.userNum+")"}),s.children&&s.children.length>0&&e(s.children)});return t}([t]),e.setState({key:"array",value:{dept:t,currentDept:xe()({},t[0],{children:null})}}),e.getDeptCallback(t)})}})},qe={name:"tree",mixins:[ze],mounted:function(){this.initDept()},watch:{filterText:function(e){this.$refs.tree2.filter(e)}},methods:xe()({},Object(Ce.d)(["setState"]),Object(Ce.b)(["getUserById"]),{getDeptCallback:function(e){var t=this;this.$nextTick(function(){t.$refs.tree2.setCurrentKey(e[0].id)}),this.isNeedUser&&this.getUserById(e[0].id)},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},handleClick:function(e){e.id!==this.currentDept.id&&(this.setState({key:"currentDept",value:xe()({},e,{children:null})}),this.isNeedUser&&this.getUserById(e.id))},handleExpand:function(e){}}),computed:xe()({},Object(Ce.e)(["currentDept","userMap"])),data:function(){return{filterText:"",defaultProps:{children:"children",label:"label"}}}},Ve={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tree"},[s("el-input",{attrs:{placeholder:"输入部门名称"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),s("div",{staticClass:"px-margin-t10"},[s("el-tree",{ref:"tree2",staticClass:"filter-tree",attrs:{"node-key":"id",data:e.dept,props:e.defaultProps,"default-expanded-keys":["1"],"filter-node-method":e.filterNode,"highlight-current":!0,"expand-on-click-node":!1},on:{"node-click":e.handleClick,"node-expand":e.handleExpand}})],1)],1)},staticRenderFns:[]};var Je=s("VU/8")(qe,Ve,!1,function(e){s("P8CB")},"data-v-0cb1764c",null).exports,We={name:"user-form",mixins:[Ue.a],data:function(){var e=this,t=function(e,t,s){t.length!==e.len?s(new Error(e.pre+"长度为"+e.len+"位")):s()},s=function(t,s,r){2===e.form.userStatus&&"transferDate"===t.t&&!s||3===e.form.userStatus&&"leaveDate"===t.t&&!s?r(new Error(t.message)):r()};return{form:{name:"",mobile:"",userId:0,sex:1,birthday:"",department:null,job:"",loginAble:!0,idCardNumber:"",detailAddress:"",joinDate:"",transferDate:"",leaveDate:"",remark:"",urgent:"",userStatus:1},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:t,len:11,pre:"手机号"}],urgent:[{required:!0,message:"请输入紧急联系人电话",trigger:"blur"},{validator:t,len:11,pre:"紧急联系人电话"}],birthday:[{required:!0,message:"请选择出生年月",trigger:"blur"}],joinDate:[{required:!0,message:"请选择入职日期",trigger:"blur"}],job:[{required:!0,message:"请输入职位",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 10 个字符",trigger:"blur"}],idCardNumber:[{required:!0,message:"请输入身份证号码",trigger:"blur"},{validator:t,len:18,pre:"身份证号码"}],detailAddress:[{required:!0,message:"请输入居住地址",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}],transferDate:[{validator:s,t:"transferDate",message:"请选择转正日期"}],leaveDate:[{validator:s,t:"leaveDate",message:"请选择离职日期"}]}}},filters:{getLabel:function(e){return e&&e.label?e.label.replace(" ("+e.userNum+")",""):""}},computed:xe()({},Object(Ce.e)(["currentDept","handleType","currentUser"])),methods:{onSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return console.log("error submit!!"),!1;var s=e.form,r=s.department,i=s.birthday,a=s.joinDate,n=s.transferDate,l=s.leaveDate,o=xe()({},e.form,{departmentId:r.id,birthday:i?i.getTime():"",joinDate:a?a.getTime():"",transferDate:n?n.getTime():"",leaveDate:l?l.getTime():""});delete o.department,"edit"===e.handleType&&(o.id=e.currentUser.id),e.http("saveUser",o).then(function(){e.$message({message:"保存成功",type:"success"}),e.$emit("toggle")})})},selectParentDept:function(){this.form.department||(this.form.department=xe()({},this.currentDept)),this.$refs.selectTree.show()},confirmSelect:function(e){this.form.department=e[0]}},props:{isEdit:{type:Boolean,default:!1}}},Ke={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-form"},[s("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"95px"}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"姓名",size:"mini",prop:"name"}},[s("el-input",{attrs:{size:"mini"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"手机号",size:"mini",prop:"mobile"}},[s("el-input",{attrs:{size:"mini"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"工号",size:"mini"}},[s("el-input",{attrs:{size:"mini",disabled:""},model:{value:e.form.userId,callback:function(t){e.$set(e.form,"userId",t)},expression:"form.userId"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"性别",size:"mini"}},[s("el-select",{attrs:{size:"mini",placeholder:"请选择性别"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[s("el-option",{attrs:{label:"男",value:1}}),e._v(" "),s("el-option",{attrs:{label:"女",value:2}})],1)],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"出生年月",size:"mini",prop:"birthday"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",size:"mini",placeholder:"选择日期"},model:{value:e.form.birthday,callback:function(t){e.$set(e.form,"birthday",t)},expression:"form.birthday"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("div",{on:{click:e.selectParentDept}},[s("el-form-item",{attrs:{label:"所属部门",size:"mini"}},[s("p",{staticClass:"color-info cursor-p over-text"},[e._v("\n              "+e._s(e._f("getLabel")(e.form.department?e.form.department:e.currentDept))+"\n            ")])])],1)])],1),e._v(" "),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"所属职位",size:"mini",prop:"job"}},[s("el-input",{attrs:{size:"mini"},model:{value:e.form.job,callback:function(t){e.$set(e.form,"job",t)},expression:"form.job"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"员工状态",size:"mini"}},[s("el-select",{attrs:{size:"mini",placeholder:"请选择员工状态"},model:{value:e.form.userStatus,callback:function(t){e.$set(e.form,"userStatus",t)},expression:"form.userStatus"}},[s("el-option",{attrs:{label:"试用期",value:1}}),e._v(" "),s("el-option",{attrs:{label:"正式员工",value:2}}),e._v(" "),s("el-option",{attrs:{label:"已离职",value:3}})],1)],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"允许登陆",size:"mini"}},[s("el-switch",{model:{value:e.form.loginAble,callback:function(t){e.$set(e.form,"loginAble",t)},expression:"form.loginAble"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"身份证号",size:"mini",prop:"idCardNumber"}},[s("el-input",{attrs:{size:"mini"},model:{value:e.form.idCardNumber,callback:function(t){e.$set(e.form,"idCardNumber",t)},expression:"form.idCardNumber"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"居住地址",size:"mini",prop:"detailAddress"}},[s("el-input",{attrs:{size:"mini"},model:{value:e.form.detailAddress,callback:function(t){e.$set(e.form,"detailAddress",t)},expression:"form.detailAddress"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"入职日期",size:"mini",prop:"joinDate"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"date",placeholder:"选择日期"},model:{value:e.form.joinDate,callback:function(t){e.$set(e.form,"joinDate",t)},expression:"form.joinDate"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"转正日期",size:"mini",prop:"transferDate"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"date",placeholder:"选择日期"},model:{value:e.form.transferDate,callback:function(t){e.$set(e.form,"transferDate",t)},expression:"form.transferDate"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"离职日期",size:"mini",prop:"leaveDate"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"date",placeholder:"选择日期"},model:{value:e.form.leaveDate,callback:function(t){e.$set(e.form,"leaveDate",t)},expression:"form.leaveDate"}})],1)],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"紧急联系人",size:"mini",prop:"urgent"}},[s("el-input",{attrs:{size:"mini",placeholder:"请输入紧急联系人电话"},model:{value:e.form.urgent,callback:function(t){e.$set(e.form,"urgent",t)},expression:"form.urgent"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"备注说明",size:"mini"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{size:"mini"}},[s("div",{staticClass:"text-right"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onSubmit}},[e._v("确定")])],1)])],1),e._v(" "),s("select-tree",{ref:"selectTree",attrs:{title:"选择所属部门",selectedDept:e.form.department?[e.form.department]:[],selectedUser:[],selectType:1,isSingleDept:!0,isNeedUser:!1},on:{confirm:e.confirmSelect}})],1)},staticRenderFns:[]};var He=s("VU/8")(We,Ke,!1,function(e){s("rD0i")},"data-v-6aed112e",null).exports,Qe={name:"user-table",methods:xe()({},Object(Ce.d)(["setState"]),{handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},handleClick:function(e){var t=this;this.dialogVisible=!0,this.setState({key:"handleType",value:"edit"}),this.setState({key:"currentUser",value:e}),this.$nextTick(function(){t.$refs.editUserPanel.form=xe()({},e)})},delUser:function(e){this.$confirm("确定要删除吗？").then(function(){console.log(e)})}}),mounted:function(){0===this.userTableHeight&&this.setState({key:"userTableHeight",value:document.body.clientHeight-200})},computed:xe()({},Object(Ce.e)(["userTableHeight"]),Object(Ce.c)(["userList","contactPriv"])),data:function(){return{dialogVisible:!1}},components:{UserForm:He}},Ze={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-table"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,stripe:!0,"highlight-current-row":!0,height:e.userTableHeight,size:"mini",border:""}},[s("el-table-column",{attrs:{fixed:"",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[s("el-form-item",{attrs:{label:"姓名"}},[s("span",[e._v(e._s(t.row.name))])]),e._v(" "),s("el-form-item",{attrs:{label:"性别"}},[s("span",[e._v(e._s(t.row.sex))])]),s("br"),e._v(" "),s("el-form-item",{attrs:{label:"手机号"}},[s("span",[e._v(e._s(t.row.mobile))])]),e._v(" "),s("el-form-item",{attrs:{label:"出生日期"}},[s("span",[e._v(e._s(t.row.birthdayF))])]),s("br"),e._v(" "),s("el-form-item",{attrs:{label:"所属部门"}},[s("span",[e._v(e._s(t.row.department))])]),e._v(" "),s("el-form-item",{attrs:{label:"所属职位"}},[s("span",[e._v(e._s(t.row.job))])]),s("br"),e._v(" "),s("el-form-item",{attrs:{label:"身份证号"}},[s("span",[e._v(e._s(t.row.idCardNumber))])]),e._v(" "),s("el-form-item",{attrs:{label:"入职日期"}},[s("span",[e._v(e._s(t.row.joinDateF))])]),s("br"),e._v(" "),s("el-form-item",{attrs:{label:"转正日期"}},[s("span",[e._v(e._s(t.row.transferDateF))])]),e._v(" "),s("el-form-item",{attrs:{label:"离职日期"}},[s("span",[e._v(e._s(t.row.leaveDateF))])]),s("br"),e._v(" "),s("el-form-item",{attrs:{label:"居住地址"}},[s("span",[e._v(e._s(t.row.detailAddress))])]),e._v(" "),s("el-form-item",{attrs:{label:"备注"}},[s("span",[e._v(e._s(t.row.remark))])]),s("br"),e._v(" "),s("el-form-item",{attrs:{label:"紧急联系人"}},[s("span",[e._v(e._s(t.row.urgent))])]),s("br")],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"姓名",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{prop:"mobile",label:"手机号",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"sex",label:"性别",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{prop:"birthdayF",label:"出生日期",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"department",label:"所属部门",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"job",label:"所属职位",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"idCardNumber",label:"身份证号",width:"150"}}),e._v(" "),s("el-table-column",{attrs:{prop:"joinDateF",label:"入职日期",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"transferDateF",label:"转正日期",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"leaveDateF",label:"离职日期",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"detailAddress",label:"居住地址",width:"200"}}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return e.contactPriv.user?[s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(s){e.handleClick(t.row)}}},[e._v("编辑")])]:void 0}}])})],1),e._v(" "),s("el-dialog",{attrs:{width:"50%",title:"编辑人员",visible:e.dialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("user-form",{ref:"editUserPanel"})],1)],1)},staticRenderFns:[]};var Ye=s("VU/8")(Qe,Ze,!1,function(e){s("CKqx")},null,null).exports,Ge={name:"page",methods:{handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e)}},data:function(){return{currentPage:1}},computed:xe()({},Object(Ce.c)(["userList"]))},Xe={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[20,30,40,50,100],"page-size":20,background:"",layout:"prev, pager, next, sizes, jumper",total:e.userList.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})},staticRenderFns:[]};var et=s("VU/8")(Ge,Xe,!1,function(e){s("m2a4")},null,null).exports,tt={name:"dept-form",mixins:[Ue.a],data:function(){return{form:{label:"",sequence:""},rules:{label:[{required:!0,message:"请输入部门名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}]}}},computed:xe()({},Object(Ce.e)(["handleType","currentDept"])),methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var s=xe()({},t.form);"edit"===t.handleType?s.id=t.currentDept.id:s.parentId=t.currentDept.id,t.http("saveDept",s).then(function(){t.$message({message:"保存成功",type:"success"}),t.$emit("toggle")})})}}},st={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dept-form"},[s("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"部门名称",prop:"label"}},[s("el-input",{model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"部门排序"}},[s("el-input",{model:{value:e.form.sequence,callback:function(t){e.$set(e.form,"sequence",t)},expression:"form.sequence"}})],1),e._v(" "),s("div",{staticClass:"text-right"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var rt,it=s("VU/8")(tt,st,!1,function(e){s("FA5p")},"data-v-2c0083f6",null).exports,at=function(e){return""+e.label.replace("("+e.userNum+")","")},nt={name:"dept-user",components:(rt={Page:et,UserTable:Ye,Tree:Je},Re()(rt,it.name,it),Re()(rt,He.name,He),rt),data:function(){return{dialogVisible:!1,deptDialogTitle:"",currentDialogComponent:"",dialogWidth:""}},created:function(){},computed:xe()({},Object(Ce.e)(["currentDept","userInfo"]),Object(Ce.c)(["contactPriv"]),{isShowOpt:function(){return this.contactPriv}}),methods:xe()({},Object(Ce.d)(["setState"]),{handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},editDept:function(e){var t=this;this.dialogWidth="30%",this.currentDialogComponent=it.name,this.deptDialogTitle=e?"编辑部门":"添加部门",this.dialogVisible=!0,this.setState({key:"handleType",value:e?"edit":"add"}),this.$nextTick(function(){var s=t.$refs.dialog.$refs.form;e?(s.model.label=at(t.currentDept),s.model.sequence=t.currentDept.sequence):s.resetFields()})},delDept:function(){this.$confirm("确认删除？").then(function(e){done()}).catch(function(e){})},editUser:function(e){this.dialogWidth="50%",this.currentDialogComponent=He.name,this.deptDialogTitle=e?"编辑员工":"添加员工",this.dialogVisible=!0,this.setState({key:"handleType",value:e?"edit":"add"})}}),filters:{formatLabel:function(e){return at(e)}}},lt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dept-user width-100 height-100 position-r"},[s("div",{staticClass:"dept-user__tree position-r height-100 bg-fff"},[s("div",{staticClass:"position-a width-100 top-0 px-bottom-50 px-padding-10"},[s("tree")],1),e._v(" "),e.isShowOpt.imp?s("div",{staticClass:"position-a px-line-50 font-0 width-100 dept-user__import-contact bottom-0 text-center color-info"}):e._e()]),e._v(" "),s("div",{staticClass:"dept-user__user height-100 position-a right-0 top-0 bg-fff overflow-a"},[s("div",{staticClass:"dept-user__option-panel px-padding-10"},[s("div",{staticClass:"fr"},[e.isShowOpt.user?s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.editUser(!1)}}},[e._v("添加员工")]):e._e(),e._v(" "),e.isShowOpt.dept?s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.editDept(!1)}}},[e._v("添加部门")]):e._e()],1),e._v(" "),e.currentDept?[s("span",{staticClass:"color-c999"},[e._v("当前部门：")]),e._v(" "),s("span",[e._v(e._s(e._f("formatLabel")(e.currentDept)))]),e._v(" "),e.isShowOpt.dept?[s("a",{attrs:{href:"javascript:"},on:{click:function(t){e.editDept(!0)}}},[e._v("编辑")]),e._v(" "),s("span",[e._v("/")]),e._v(" "),s("a",{staticClass:"color-error",attrs:{href:"javascript:"},on:{click:e.delDept}},[e._v("删除")])]:e._e()]:e._e()],2),e._v(" "),s("div",{staticClass:"px-padding-10"},[s("user-table")],1),e._v(" "),s("div",{staticClass:"text-center"},[s("page")],1)]),e._v(" "),s("el-dialog",{attrs:{width:e.dialogWidth,title:e.deptDialogTitle,visible:e.dialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[s(e.currentDialogComponent,{ref:"dialog",tag:"component",on:{handleClick:e.editUser,toggle:function(t){e.dialogVisible=!1}}})],1)],1)},staticRenderFns:[]};var ot=s("VU/8")(nt,lt,!1,function(e){s("rg67")},null,null).exports,ct=s("mvHQ"),ut=s.n(ct),pt={name:"priv",data:function(){return{dialogTitle:"",dialogVisible:!1,menu:ye.h,contactPriv:ye.g,currentDialog:"",currentEditPriv:null,form:{selectedMenu:[],selectedContact:[],targetDept:[],targetUser:[]},priv:null}},created:function(){this.getPriv()},mixins:[Ue.a],computed:{},methods:{getPriv:function(){var e=this;this.http("getPrivList").then(function(t){e.priv=t.map(function(e){return e.aliasName=[].concat(e.targetDept.map(function(e){return e.label}),e.targetUser.map(function(e){return e.name})).join("、"),e.aliasMenu=e.privMenu.map(function(e){return(ye.h.find(function(t){return t.id===e})||{}).title}).join("、"),e.aliasContact=e.privContact.map(function(e){return(ye.g.find(function(t){return t.id===e})||{}).title}).join("、"),e})})},onSubmit:function(){var e=this,t=this.form,s=t.targetDept,r=t.targetUser,i=t.selectedMenu,a=t.selectedContact;if(0!==s.length||0!==r.length)if(0!==i.length||0!==a.length){var n=i.map(function(t){return e.menu.find(function(e){return e.title===t}).id}),l=a.map(function(t){return e.contactPriv.find(function(e){return e.title===t}).id}),o={targetDept:ut()(s.map(function(e){return{id:e.id,label:e.label}})),targetUser:ut()(r.map(function(e){return{userId:e.userId,name:e.name}})),menuPrivIdList:ut()(n),contactPrivIdList:ut()(l)},c="addPriv",u="添加权限成功";this.currentEditPriv&&(c="editPriv",u="修改权限成功",o.id=this.currentEditPriv.id),this.http(c,o).then(function(){e.$message.success(u),e.dialogVisible=!1,e.getPriv()})}else this.$message.error("请选择对应权限");else this.$message.error("请选择部门或人员")},editPriv:function(e){var t=this;this.currentEditPriv=e,this.dialogVisible=!0,this.dialogTitle="编辑权限",this.form.targetDept=e.targetDept,this.form.targetUser=e.targetUser,this.form.selectedMenu=e.privMenu.map(function(e){return t.menu.find(function(t){return t.id===e}).title}),this.form.selectedContact=e.privContact.map(function(e){return t.contactPriv.find(function(t){return t.id===e}).title})},delPriv:function(e){var t=this;this.$msgbox.confirm("确定要删除吗？").then(function(){t.http("delPriv",{id:e.id}).then(function(){t.$message.success("删除成功"),t.getPriv()})})},addPriv:function(){this.currentEditPriv=null,this.dialogVisible=!0,this.dialogTitle="添加权限",this.form.targetDept=[],this.form.targetUser=[],this.form.selectedMenu=[],this.form.selectedContact=[]},confirmSelect:function(e,t){this.form.targetDept=e,this.form.targetUser=t},showDialogSelectName:function(){var e=this.form,t=e.targetDept,s=e.targetUser;return 0===t.length&&0===s.length?"请选择":t.map(function(e){return e.label.replace("("+e.userNum+")","")}).join("、")+(s.length>0?"、":"")+s.map(function(e){return e.name}).join("、")}}},dt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bg-fff px-padding-20 height-100"},[s("div",{staticClass:"priv__wrap"},[s("div",{staticClass:"fr"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.addPriv()}}},[e._v("添加权限")])],1),e._v(" "),s("h1",{staticClass:"px-font-18 color-c666 px-margin-b20"},[e._v("权限列表")]),e._v(" "),e.priv?s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.priv}},[s("el-table-column",{attrs:{prop:"aliasName",label:"权限对象"}}),e._v(" "),s("el-table-column",{attrs:{prop:"aliasMenu",label:"菜单权限"}}),e._v(" "),s("el-table-column",{attrs:{prop:"aliasContact",label:"操作权限"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("a",{staticClass:"color-info",attrs:{href:"javascript:"},on:{click:function(s){e.editPriv(t.row)}}},[e._v("编辑")]),e._v(" "),s("a",{staticClass:"color-error",attrs:{href:"javascript:"},on:{click:function(s){e.delPriv(t.row)}}},[e._v("删除")])]}}])})],1):e._e()],1),e._v(" "),e._e(),e._v(" "),e._e(),e._v(" "),s("el-dialog",{attrs:{width:"600px",title:e.dialogTitle,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[s("div",[s("span",{staticClass:"ib-middle px-width-100 text-right px-padding-r15"},[e._v("选择对象")]),e._v(" "),s("a",{attrs:{href:"javascript:"},on:{click:function(t){e.$refs.selectTree.show()}}},[e._v(e._s(e.showDialogSelectName()))])]),e._v(" "),s("el-form-item",{attrs:{label:"菜单权限"}},[s("el-checkbox-group",{model:{value:e.form.selectedMenu,callback:function(t){e.$set(e.form,"selectedMenu",t)},expression:"form.selectedMenu"}},e._l(e.menu,function(e){return s("el-checkbox",{key:e.id,attrs:{label:e.title,name:e.componentName}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"操作权限"}},[s("el-checkbox-group",{model:{value:e.form.selectedContact,callback:function(t){e.$set(e.form,"selectedContact",t)},expression:"form.selectedContact"}},e._l(e.contactPriv,function(e){return s("el-checkbox",{key:e.id,attrs:{label:e.title,name:e.componentName}})}))],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")])],1)],1)],1),e._v(" "),s("select-tree",{ref:"selectTree",attrs:{selectedDept:e.form.targetDept,selectedUser:e.form.targetUser,selectType:0},on:{confirm:e.confirmSelect}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{staticClass:"px-font-18 color-c666"},[this._v("菜单权限"),t("small",{staticClass:"color-ccc"},[this._v("（部门或人）")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{staticClass:"px-font-18 color-c666"},[this._v("组织架构操作权限"),t("small",{staticClass:"color-ccc"},[this._v("（人）")])])}]};var mt=s("VU/8")(pt,dt,!1,function(e){s("sRqJ")},null,null).exports,ft={name:"job",data:function(){return{jobList:[],currJob:null,isEdit:!1,dialogTitle:"",dialogVisible:!1,form:{label:"",sequence:""},rules:{label:[{required:!0,message:"请输入岗位名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}]}}},mixins:[Ue.a],created:function(){this.getJobList()},computed:xe()({},Object(Ce.c)(["otherPriv"])),methods:{getJobList:function(){var e=this;this.http("jobList").then(function(t){t.length>0&&(e.jobList=t,e.currJob=t[0])})},addJob:function(e){this.isEdit=e,this.dialogVisible=!0,this.dialogTitle=e?"编辑岗位 - "+this.currJob.name:"添加岗位"},delJob:function(){var e=this;this.http("delJob",{id:this.currJob.id}).then(function(){e.$message.success("删除岗位成功"),e.getJobList()})},confirmAdd:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return console.log("error submit!!"),!1;var s=xe()({},e.form);e.isEdit&&(s.id=e.currJob.id),e.http("addJob",e.form).then(function(){e.$message({message:e.isEdit?"编辑岗位成功":"添加岗位成功",type:"success"}),e.getJobList()}),e.dialogVisible=!1})},addUserToJob:function(){this.$refs.selectTree.show()},confirmSelect:function(e,t){var s=this;0!==t.length?this.http("addUserToJob",{userIds:ut()(t.map(function(e){return e.userId})),jobId:this.currJob.id}).then(function(){s.$message({message:s.currJob.name+"岗位添加人员成功",type:"success"}),s.getJobList()}):this.$message("请选择人员")},delJobUser:function(e){var t=this;this.$confirm("确定要删除吗？").then(function(){t.http("delJobUser",xe()({},e,{jobId:t.currJob.id})).then(function(e){t.$message({message:t.currJob.name+"岗位删除人员成功",type:"success"}),t.getJobList()})})}}},vt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"job height-100 bg-fff position-r"},[e.otherPriv.job?s("div",{staticClass:"px-line-50 px-padding-lr10 bd-gray-lighter-b"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.addJob()}}},[e._v("添加岗位")]),e._v(" "),e.currJob?[s("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){e.addJob(!0)}}},[e._v("编辑岗位")]),e._v(" "),s("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){e.delJob()}}},[e._v("删除岗位")]),e._v(" "),s("el-button",{attrs:{type:"info",size:"mini"},on:{click:e.addUserToJob}},[e._v("添加人员")])]:e._e()],2):e._e(),e._v(" "),s("div",{staticClass:"job__list position-a bottom-0 bd-gray-lighter-r overflow-a",class:e.otherPriv.job?"px-top-50":"top-0"},[s("p",{staticClass:"px-line-40 text-center color-c999"},[e._v("岗位列表")]),e._v(" "),e._l(e.jobList,function(t){return s("div",{key:t.id,class:"bd-gray-lighter-b px-line-40 px-padding-lr10 cursor-p "+(e.currJob.id===t.id?"curr":""),on:{click:function(s){e.currJob=t}}},[e._v("\n      "+e._s(t.name)+"\n      "),s("span",{staticClass:"fr el-icon-arrow-right color-ccc px-margin-t15"})])})],2),e._v(" "),s("div",{staticClass:"job__user position-a bottom-0 right-0",class:e.otherPriv.job?"px-top-50":"top-0"},[s("div",{staticClass:"bd-gray-lighter-b"},[s("div",{staticClass:"px-line-40 text-center w200 color-c999 ib-middle bd-gray-lighter-r"},[e._v("人员列表")]),e._v(" "),s("div",{staticClass:"px-line-40 text-center w200 color-c999 ib-middle bd-gray-lighter-r"},[e._v("所属部门")]),e._v(" "),e.otherPriv.job?s("div",{staticClass:"px-line-40 text-center w200 color-c999 ib-middle bd-gray-lighter-r"},[e._v("操作")]):e._e()]),e._v(" "),e._l(e.currJob?e.currJob.users:[],function(t){return e.currJob&&e.currJob.users.length>0?s("div",{staticClass:"bd-gray-lighter-b"},[s("div",{staticClass:"px-line-40 bd-gray-lighter-r px-padding-lr10 w200 ib-middle"},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"px-line-40 bd-gray-lighter-r px-padding-lr10 w200 ib-middle"},[e._v(e._s(t.deptName))]),e._v(" "),e.otherPriv.job?s("div",{staticClass:"px-line-40 bd-gray-lighter-r px-padding-lr10 w200 ib-middle"},[s("a",{attrs:{href:"javascript:"},on:{click:function(s){e.delJobUser(t)}}},[e._v("删除")])]):e._e()]):e._e()})],2),e._v(" "),s("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"400px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"岗位名称",prop:"label"}},[s("el-input",{model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"岗位排序"}},[s("el-input",{model:{value:e.form.sequence,callback:function(t){e.$set(e.form,"sequence",t)},expression:"form.sequence"}})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.confirmAdd}},[e._v("确 定")])],1)],1),e._v(" "),s("select-tree",{ref:"selectTree",attrs:{selectedDept:[],selectedUser:[],selectType:2},on:{confirm:e.confirmSelect}})],1)},staticRenderFns:[]};var ht=s("VU/8")(ft,vt,!1,function(e){s("ylbK")},null,null).exports,_t={name:"money-system-apply",mixins:[Ue.a],watch:{userInfo:function(e){return e&&(this.form.expenseDept=e.dept),e}},created:function(){this.form.expenseDept=this.userInfo&&this.userInfo.dept?xe()({},this.userInfo.dept,{id:this.userInfo.dept.deptId}):{},this.getProcess(this.userInfo.dept.deptId)},data:function(){return{expenseUploadUrl:(this.$utils.dev?"http://oa.ixunle.com":"")+"/service/logic/controller/IndexController.php?act=upload&met=expenseCred",payWay:ye.c,payType:ye.b,form:{money:"",way:"",desc:"",payTime:"",payType:[],expenseDept:null,imagesList:[]},rules:{desc:[{required:!0,message:"请输入报销事由",trigger:"blur"},{min:1,max:500,message:"长度在 1 到 500 个字符",trigger:"blur"}],money:[{required:!0,message:"请输入金额",trigger:"blur"},{type:"number",message:"金额为数字",trigger:"blur"},{validator:function(e,t,s){t>e.max||t<=e.min?s(new Error(e.message)):s()},min:0,max:1e8,message:"金额在0-100,000,000之间",trigger:"blur"}],way:[{required:!0,message:"请选择支出方式"}],payType:[{required:!0,message:"请选择支出类别"}],payTime:[{type:"date",required:!0,message:"请选择时间",trigger:"change"}],imagesList:[{required:!0,message:"请上传图片材料"}]},processData:{}}},computed:xe()({},Object(Ce.e)(["userInfo"]),{hasSetProcess:function(){return this.processData.process&&this.processData.process.length>0},processStr:function(){var e=this.processData.process||[];return["我(发起人)"].concat(e.map(function(e){return e.name+(e.jobName?"("+e.jobName+")":"")})).join(" -> ")}}),methods:{getProcess:function(e){var t=this;this.http("getProcess",{userId:1,deptId:e,processType:1}).then(function(e){t.processData=e})},handleRemove:function(e,t){var s=this.form.imagesList.findIndex(function(t){return t.id||t.uid===e.id||e.uid});this.form.imagesList.splice(s,1)},handlePreview:function(e){window.open(e.url)},handleSuccess:function(e,t){this.form.imagesList.push(e.data)},submitForm:function(e){var t=this;if(!this.hasSetProcess)return this.$msgbox.alert("当前部门还未设置对应报销流程，请联系管理员设置后使用"),!1;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var s=t.form.expenseDept,r=s.deptId,i=s.id,a=t.form.imagesList.map(function(e){return e.iid});t.http("applyExpense",xe()({},t.form,{processId:t.processData.id,expenseDept:r||i,payTime:t.form.payTime.getTime(),payType:ut()(t.form.payType),imagesList:ut()(a)})).then(function(){t.$message({message:"申请成功",type:"success"})})})},resetForm:function(e){this.$refs[e].resetFields(),this.form.expenseDept=this.userInfo.dept,this.form.imagesList=[]},toSelectDept:function(){this.$refs.selectTree.show()},confirmSelectDept:function(e){0!==e.length&&(e.length>1&&this.$message("默认取第一个部门"),this.form.expenseDept=xe()({},e[0]),this.getProcess(e[0].id))}}},bt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"money-apply"},[e.hasSetProcess||void 0===e.processData.id?e._e():s("div",{staticClass:"px-margin-b20"},[s("el-alert",{attrs:{title:"提示",type:"error",description:"当前部门还未设置对应报销流程，请联系管理员设置后使用",closable:!1}})],1),e._v(" "),s("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"报销事由",prop:"desc"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"报销金额",prop:"money"}},[s("el-input",{attrs:{type:"number"},model:{value:e.form.money,callback:function(t){e.$set(e.form,"money",e._n(t))},expression:"form.money"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"支出类别",prop:"payType"}},[s("el-cascader",{attrs:{"expand-trigger":"hover",options:e.payType},model:{value:e.form.payType,callback:function(t){e.$set(e.form,"payType",t)},expression:"form.payType"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"支出方式",prop:"way"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.way,callback:function(t){e.$set(e.form,"way",t)},expression:"form.way"}},e._l(e.payWay,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"支出时间",prop:"payTime"}},[s("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.form.payTime,callback:function(t){e.$set(e.form,"payTime",t)},expression:"form.payTime"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"报销部门"}},[s("div",{staticClass:"display-ib cursor-p",on:{click:e.toSelectDept}},[e.form.expenseDept?s("span",{staticClass:"color-info"},[e._v(e._s(e.form.expenseDept.name))]):e._e()])]),e._v(" "),s("el-form-item",{attrs:{label:"相关图片",prop:"imagesList"}},[s("el-upload",{staticClass:"upload-demo",attrs:{action:e.expenseUploadUrl,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"file-list":e.form.imagesList,"list-type":"picture"}},[s("el-button",{attrs:{size:"small",type:"danger"}},[e._v("点击上传")]),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("tips: 1-9张，只能上传jpg/png文件，且不超过500kb")])],1)],1),e._v(" "),e.hasSetProcess?s("div",{staticClass:"process px-margin-b50"},[s("el-alert",{attrs:{title:"系统已设置报销流程",type:"info",closable:!1,description:e.processStr,"show-icon":""}})],1):e._e(),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"danger"},on:{click:function(t){e.submitForm("form")}}},[e._v("提交申请")]),e._v(" "),s("el-button",{on:{click:function(t){e.resetForm("form")}}},[e._v("重置表单")])],1)],1),e._v(" "),s("select-tree",{ref:"selectTree",attrs:{selectedDept:[],selectedUser:[],selectType:1,isNeedUser:!1,isSingleDept:!0},on:{confirm:e.confirmSelectDept}})],1)},staticRenderFns:[]};var gt=s("VU/8")(_t,bt,!1,function(e){s("Ni4G")},null,null).exports,xt={name:"money-system-detail",data:function(){return{detail:null,BX_STATUS:ye.a}},watch:{item:function(e){return console.log(1),e}},props:["item"],mixins:[Ue.a],created:function(){this.getDetail()},methods:{getDetail:function(){var e=this;this.http("getExpenseDetail",{expenseId:this.item.id}).then(function(t){t.statusText=ye.a.find(function(e){return Number(e.value)===Number(t.status)}).label,t.process=t.process.map(function(e){var t=ye.a.find(function(t){return Number(t.value)===Number(e.status)});return xe()({},e,{processIcon:t.icon,processColor:t.color,processText:t.label})}),e.detail=t})}}},Ct={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.detail?s("div",{staticClass:"expense-detail"},[s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("报销状态：")]),e._v(" "),s("span",{staticClass:"color-warning"},[e._v(e._s(e.detail.statusText))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("报销事由：")]),e._v(" "),s("span",[e._v(e._s(e.detail.desc)+" ")])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("报销金额：")]),e._v(" "),s("span",[e._v(e._s(e.detail.money)+"元")])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("支出类别：")]),e._v(" "),s("span",[e._v(e._s(e.detail.payType.join("/")))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("支出方式：")]),e._v(" "),s("span",[e._v(e._s(e.detail.way))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("支出时间：")]),e._v(" "),s("span",[e._v(e._s(e.$utils.formatTime(e.detail.payTime)))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("报销部门：")]),e._v(" "),s("span",[e._v(e._s(e.detail.label))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("报销时间：")]),e._v(" "),s("span",[e._v(e._s(e.$utils.formatTime(e.detail.createTime)))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999 ib-top"},[e._v("相关图片：")]),e._v(" "),e.detail.images.length>0?s("div",{staticClass:"ib-top"},e._l(e.detail.images,function(e){return s("a",{staticClass:"ib-middle px-margin-10",attrs:{href:e.url,target:"_blank"}},[s("img",{attrs:{src:e.url,width:"70",height:"70"}})])})):s("span",[e._v("无")])]),e._v(" "),s("p",{staticClass:"px-margin-t20"},[e._v("报销流程")]),e._v(" "),s("div",{staticClass:"process__wrap position-r"},[e._l(e.detail.process,function(t){return s("div",{staticClass:"process__item position-r"},[s("p",{class:"process__state "+t.processColor},[s("span",{staticClass:"ib-middle px-margin-r5"},[e._v(e._s(t.name)),t.job?s("span",[e._v("("+e._s(t.job)+")")]):e._e()])]),e._v(" "),s("div",{staticClass:"process__info text-right bg-f2 cl"},[s("span",{class:"fl "+t.processColor},[e._v(e._s(t.processText))]),e._v(" "),s("span",{staticClass:"color-c999"},[e._v(e._s(e.$utils.formatTime(t.time)))]),e._v(" "),t.desc?s("p",{staticClass:"text-left"},[s("span",{staticClass:"color-c999"},[e._v("意见：")]),e._v(" "),s("span",[e._v(e._s(t.desc))])]):e._e()]),e._v(" "),s("div",{staticClass:"position-a process__item-icon"},[s("i",{class:t.processIcon+" "+t.processColor})])])}),e._v(" "),s("div",{staticClass:"process_line position-a"})],2)]):e._e()},staticRenderFns:[]};var yt=s("VU/8")(xt,Ct,!1,function(e){s("MLwL")},null,null).exports,wt={name:"money-system-list",data:function(){return{payType:ye.b,tableWrapHeight:this.wrapHeight-110,currentPage:1,dialogVisible:!1,currentChooseItem:null,listData:[],bxStatus:ye.a,listType:0,listPayType:[],listTime:[],listKeyword:"",listBxStatus:"",listBxDept:[],listBxUser:[]}},created:function(){},mixins:[Ue.a],watch:{wrapHeight:function(e){return this.tableWrapHeight=e-110,e},activeName:function(e){return this.reset(),"fourth"!==e&&this.getExpenseList(),e}},mounted:function(){this.isTotal||this.getExpenseList()},methods:{beforeClose:function(e){this.currentChooseItem=null,e()},confirmSearch:function(){this.reset(),this.getExpenseList()},resetSearch:function(){this.reset(),this.listType=0,this.listPayType=[],this.listTime=[],this.listKeyword="",this.listBxStatus="",this.listBxDept=[],this.listBxUser=[]},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e)},confirmSelectTree:function(e,t){this.listBxDept=e,this.listBxUser=t},reset:function(){this.listData=[],this.currentChooseItem=null,this.currentPage=1},getExpenseList:function(){var e=this,t=[],s=[],r=[];this.listTime.length>0&&(t=[this.listTime[0].getTime(),this.listTime[1].getTime()]),this.listBxDept.length>0&&(s=this.listBxDept.map(function(e){return e.id})),this.listBxUser.length>0&&(r=this.listBxUser.map(function(e){return e.userId})),this.http("getExpenseList",{currentPage:1,pageSize:10,listType:this.isFromMe?1:this.isToMe?2:3,payType:ut()(this.listPayType),createTimeBetween:ut()(t),expenseDept:ut()(s),expenseUserId:ut()(r),keyword:this.listKeyword,expenseStatus:this.listBxStatus}).then(function(t){e.listData=t.list.map(function(t){return xe()({},t,{createTime:e.$utils.formatTime(t.createTime),payTime:e.$utils.formatTime(t.payTime),expenseStatus:ye.a.find(function(e){return Number(e.value)===Number(t.status)}).label})})})},doOption:function(e,t){var s=this;switch(t&&(this.currentChooseItem=t),e){case 0:this.dialogVisible=!0;break;case 1:this.$msgbox.prompt("请输入同意意见(非必填)").then(function(e){r.call(s,{status:3,message:e.value})});break;case 2:this.$msgbox.prompt("请输入拒绝意见(必填)").then(function(e){e.value?r.call(s,{status:4,message:e.value}):s.$message.error("请输入意见")});break;case 3:this.$msgbox.confirm("确定要撤回吗？").then(function(){r.call(s,{status:8})});break;case 4:this.$msgbox.confirm("即将打款金额为"+t.money+"元给"+t.name+"，确定要继续吗？").then(function(){r.call(s,{status:6})});break;case 5:this.$msgbox.confirm("确定要撤销打款吗？")}function r(e){var t=this;this.http("handleProcessStatus",xe()({},e,{expenseId:this.currentChooseItem.id})).then(function(){var s=3===e.status?"同意":4===e.status?"拒绝":3===e.status?"撤回":"打款";t.$message.success(s+"成功"),t.dialogVisible=!1})}}},props:{activeName:String,wrapHeight:{type:Number,default:0}},computed:{isFromMe:function(){return"second"===this.activeName},isToMe:function(){return"third"===this.activeName},isTotal:function(){return"fourth"===this.activeName},isCaiWu:function(){return!0}},components:{Detail:yt}},Dt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"list"},[s("div",{staticClass:"position-f px-left-10 px-right-10 px-top-60 px-bottom-50 overflow-a"},[e.isTotal?s("div",[s("div",{staticClass:"search__wrap search__wrap-dept ib-middle"},[s("span",{staticClass:"ib-middle"},[e._v("报销部门或人")]),e._v(" "),s("div",{staticClass:"ib-middle dept",on:{click:function(t){e.$refs.selectTree.show()}}},[s("span",{staticClass:"color-info"},[e._v("请选择")])])]),e._v(" "),s("div",{staticClass:"search__wrap ib-middle"},[s("span",{staticClass:"ib-middle"},[e._v("支出类别")]),e._v(" "),s("div",{staticClass:"ib-middle"},[s("el-cascader",{attrs:{"expand-trigger":"hover",options:e.payType,filterable:"","change-on-select":""},model:{value:e.listPayType,callback:function(t){e.listPayType=t},expression:"listPayType"}})],1)]),e._v(" "),s("div",{staticClass:"search__wrap ib-middle"},[s("span",{staticClass:"ib-middle"},[e._v("审批状态")]),e._v(" "),s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.listBxStatus,callback:function(t){e.listBxStatus=t},expression:"listBxStatus"}},e._l(e.bxStatus,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),s("br"),e._v(" "),s("div",{staticClass:"search__wrap search__wrap-date ib-middle"},[s("span",{staticClass:"ib-middle px-width-90"},[e._v("报销发起时间")]),e._v(" "),s("div",{staticClass:"ib-middle"},[s("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.listTime,callback:function(t){e.listTime=t},expression:"listTime"}})],1)]),e._v(" "),s("div",{staticClass:"search__wrap ib-middle"},[s("span",{staticClass:"ib-middle"},[e._v("关键字")]),e._v(" "),s("div",{staticClass:"ib-middle"},[s("el-input",{attrs:{placeholder:"请输入"},model:{value:e.listKeyword,callback:function(t){e.listKeyword=t},expression:"listKeyword"}})],1)]),e._v(" "),s("div",{staticClass:"ib-middle px-margin-b15"},[s("el-button",{attrs:{type:"danger"},on:{click:e.confirmSearch}},[e._v("搜索查询")])],1),e._v(" "),s("div",{staticClass:"ib-middle px-margin-b15"},[s("el-button",{on:{click:e.resetSearch}},[e._v("重置")])],1)]):e._e(),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.listData,"show-summary":"",height:e.tableWrapHeight}},[s("el-table-column",{attrs:{prop:"no",label:"工号",sortable:"",width:"130"}}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"报销时间",width:"130"}}),e._v(" "),s("el-table-column",{attrs:{prop:"desc",label:"报销事由"}}),e._v(" "),s("el-table-column",{attrs:{prop:"money",label:"报销金额",sortable:"",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"payType[0]",label:"支出（大类）",sortable:"",width:"140"}}),e._v(" "),s("el-table-column",{attrs:{prop:"payType[1]",label:"支出（小类）",sortable:"",width:"140"}}),e._v(" "),s("el-table-column",{attrs:{prop:"expenseDept",label:"报销部门",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"报销人",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{prop:"payTime",label:"支出时间",width:"130"}}),e._v(" "),s("el-table-column",{attrs:{prop:"way",label:"支出方式",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{prop:"expenseStatus",label:"状态",sortable:"",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:120},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){e.doOption(0,t.row)}}},[e._v("查看")]),e._v(" "),e.isFromMe?[1===t.row.rstatus?s("a",{staticClass:"color-error",attrs:{href:"javascript:"},on:{click:function(s){e.doOption(3,t.row)}}},[e._v("撤回")]):e._e()]:e._e(),e._v(" "),e.isToMe?[1===t.row.rstatus?[s("a",{staticClass:"color-success",attrs:{href:"javascript:"},on:{click:function(s){e.doOption(1,t.row)}}},[e._v("同意")]),e._v(" "),s("a",{staticClass:"color-error",attrs:{href:"javascript:"},on:{click:function(s){e.doOption(2,t.row)}}},[e._v("拒绝")])]:5===t.row.rstatus?[s("a",{staticClass:"color-success",attrs:{href:"javascript:"},on:{click:function(s){e.doOption(4,t.row)}}},[e._v("打款")])]:e._e()]:e._e()]}}])})],1)],1),e._v(" "),s("div",{staticClass:"position-f px-bottom-10 width-100 text-center"},[s("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[20,30,40,50,100],"page-size":20,background:"",layout:"prev, pager, next, sizes, jumper",total:e.listData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1),e._v(" "),s("el-dialog",{attrs:{title:"报销详情",visible:e.dialogVisible,"append-to-body":!0,top:"10px",width:"500px","before-close":e.beforeClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.currentChooseItem?[s("detail",{attrs:{item:e.currentChooseItem}}),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isFromMe?[1===e.currentChooseItem.rstatus?s("a",{staticClass:"color-error",attrs:{href:"javascript:"},on:{click:function(t){e.doOption(3)}}},[e._v("撤回")]):e._e()]:e._e(),e._v(" "),e.isToMe?[1===e.currentChooseItem.rstatus?[s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){e.doOption(1)}}},[e._v("同 意")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){e.doOption(2)}}},[e._v("拒 绝")])]:5===e.currentChooseItem.rstatus?s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.doOption(4)}}},[e._v("打 款")]):e._e()]:e._e()],2)]:e._e()],2),e._v(" "),s("select-tree",{ref:"selectTree",attrs:{selectedDept:e.listBxDept,selectedUser:e.listBxUser},on:{confirm:e.confirmSelectTree}})],1)},staticRenderFns:[]};var kt=s("VU/8")(wt,Dt,!1,function(e){s("BTcN")},null,null).exports,Tt=s("uFqb"),Ut={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"setting"},[null===e.setting.process?s("div"):0!==e.setting.process.length||e.isNewProcess?e.isNewProcess?s("div",{staticClass:"w600"},[s("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"110px"}},[s("el-form-item",{attrs:{label:"流程类型"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.processType,callback:function(t){e.$set(e.form,"processType",t)},expression:"form.processType"}},e._l(e.processType,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"名称",prop:"processName"}},[s("el-input",{attrs:{type:"text"},model:{value:e.form.processName,callback:function(t){e.$set(e.form,"processName",t)},expression:"form.processName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"流程节点",prop:"process"}},[s("div",{staticClass:"color-c666"},[s("i",{staticClass:"el-icon-info color-c999",on:{click:function(t){e.toMessage("msg1")}}}),e._v(" "),s("span",[e._v(e._s(e.form.process.map(function(e){return e.name}).join("->")))]),e._v(" "),s("span",{staticClass:"cursor-p color-info",on:{click:function(t){e.toSelect("processNode")}}},[e._v("请选择")]),e._v(" "),s("span",{staticClass:"cursor-p color-error",on:{click:function(t){e.clear(1)}}},[e._v("清空")])])]),e._v(" "),s("el-form-item",{attrs:{label:"管理范围",prop:"target"}},[s("div",{staticClass:"color-c666"},[s("i",{staticClass:"el-icon-info color-c999",on:{click:function(t){e.toMessage("msg2")}}}),e._v(" "),s("span",[e._v(e._s(e._f("formatDeptUser")(e.form.target)))]),e._v(" "),s("span",{staticClass:"cursor-p color-info",on:{click:function(t){e.toSelect("processRange")}}},[e._v("请选择")]),e._v(" "),s("span",{staticClass:"cursor-p color-error",on:{click:function(t){e.clear(2)}}},[e._v("清空")])])]),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"danger"},on:{click:function(t){e.submitForm("form")}}},[e._v("确认添加")]),e._v(" "),s("el-button",{on:{click:function(t){e.isNewProcess=!1}}},[e._v("返回列表")])],1)],1)],1):s("div",[s("el-button",{attrs:{type:"danger"},on:{click:e.newProcess}},[e._v("新建流程")]),e._v(" "),e.setting.process?s("el-row",{attrs:{gutter:20}},e._l(e.setting.process,function(t){return s("el-col",{key:t.id,attrs:{span:12}},[s("el-card",{staticClass:"box-card px-margin-t20"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"color-c999"},[e._v("流程名称: ")]),e._v(" "),s("span",[e._v(e._s(t.processName))]),e._v(" "),s("el-button",{staticStyle:{float:"right",padding:"3px 0",color:"red"},attrs:{type:"text"},on:{click:function(s){e.delProcess(t)}}},[e._v("删除")]),e._v(" "),s("el-button",{staticStyle:{float:"right",padding:"3px 5px"},attrs:{type:"text"},on:{click:function(s){e.editProcess(t)}}},[e._v("编辑")])],1),e._v(" "),s("p",[s("span",{staticClass:"color-c999"},[e._v("流程节点: ")]),e._v(" "),s("span",[e._v(e._s(t.process.map(function(e){return e.name}).join(" -> ")))])]),e._v(" "),s("p",[s("span",{staticClass:"color-c999"},[e._v("流程管理范围: ")]),e._v(" "),s("span",[e._v(e._s(e._f("formatDeptUser")(t.target)))])]),e._v(" "),s("p",[s("span",{staticClass:"color-c999"},[e._v("适用: ")]),e._v(" "),s("span",[e._v(e._s(1===t.processType?"普通报销":"推广报销"))])])])],1)})):e._e()],1):s("div",{staticClass:"px-padding-tb50 text-center"},[s("p",{staticClass:"px-margin-b20 color-c666"},[e._v("你还没有配置流程哦~")]),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:e.newProcess}},[e._v("新建流程")])],1),e._v(" "),s("select-tree",{ref:"selectTree",attrs:{selectedDept:e.selectedDept,selectedUser:e.selectedUser,selectType:e.selectType,isNeedUser:!0},on:{confirm:e.confirmSelectDept}})],1)},staticRenderFns:[]};var It=function(e){s("Mrsn")},Pt=s("VU/8")(Tt.a,Ut,!1,It,null,null).exports,St={name:"money-system",mixins:[Ue.a],data:function(){return{activeName:"first",wrapHeight:0}},created:function(){},mounted:function(){this.wrapHeight=this.$refs.expense.getBoundingClientRect().height},computed:xe()({},Object(Ce.e)(["userInfo"]),Object(Ce.c)(["otherPriv"])),components:{MoneySystemApply:gt,MoneySystemList:kt,MoneySystemSetting:Pt},methods:{handleClick:function(e,t){}}},$t={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"expense",staticClass:"expense width-100 height-100 bg-fff overflow-a"},[s("div",{staticClass:"px-padding-10"},[s("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{name:"first"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-edit"}),e._v(" 填写申请")])]),e._v(" "),s("el-tab-pane",{attrs:{name:"second"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-sort-up"}),e._v(" 我发起的")])]),e._v(" "),s("el-tab-pane",{attrs:{name:"third"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-sort-down"}),e._v(" 我收到的")])]),e._v(" "),e.otherPriv.expense?s("el-tab-pane",{attrs:{name:"fourth"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-tickets"}),e._v(" 统计")])]):e._e(),e._v(" "),e.otherPriv.process?s("el-tab-pane",{attrs:{name:"five"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-setting"}),e._v(" 流程配置")])]):e._e()],1),e._v(" "),e.userInfo&&"first"===e.activeName?s("money-system-apply"):"five"===e.activeName?s("money-system-setting"):e.wrapHeight?s("money-system-list",{attrs:{"wrap-height":e.wrapHeight,"active-name":e.activeName}}):e._e()],1)])},staticRenderFns:[]};var jt=s("VU/8")(St,$t,!1,function(e){s("3Zcx")},null,null).exports,Et={name:"money-system-apply",mixins:[Ue.a],watch:{userInfo:function(e){return e&&(this.form.expenseDept=e.dept),e}},created:function(){this.form.expenseDept=this.userInfo&&this.userInfo.dept?xe()({},this.userInfo.dept,{id:this.userInfo.dept.deptId}):{},this.getProcess(this.userInfo.dept.deptId)},data:function(){return{plate:ye.e,project:ye.f,form:{money:"",plate:1,desc:"",payTime:"",payType:[],husband:"",point:"",project:[],refund:"",expenseDept:null,targetUserName:"",targetUserMobile:"",targetUserCompany:"",targetUserContactQQ:"",targetUserContactWx:""},rules:{desc:[{required:!0,message:"请输入申报说明",trigger:"blur"},{min:1,max:500,message:"长度在 1 到 500 个字符",trigger:"blur"}],plate:{required:!0},husband:{required:!0,message:"请输入账户",min:1,max:100,trigger:"blur"},targetUserName:{required:!0,message:"请输入对接人姓名",min:1,max:10,trigger:"blur"},targetUserMobile:{required:!0,message:"请输入对接人手机号",min:1,max:11,trigger:"blur"},targetUserCompany:{required:!0,message:"请输入对接人公司名称",min:1,max:100,trigger:"blur"},point:{required:!0,message:"请输入返点",min:1,max:100,trigger:"blur"},money:[{required:!0,message:"请输入充值金额",trigger:"blur"},{type:"number",message:"金额为数字",trigger:"blur"},{validator:function(e,t,s){t>e.max||t<=e.min?s(new Error(e.message)):s()},min:0,max:1e8,message:"金额在0-100,000,000之间",trigger:"blur"}],project:[{required:!0,message:"请选择申报项目"}]},processData:{}}},computed:xe()({},Object(Ce.e)(["userInfo"]),{hasSetProcess:function(){return this.processData.process&&this.processData.process.length>0},processStr:function(){var e=this.processData.process||[];return["我(发起人)"].concat(e.map(function(e){return e.name+(e.jobName?"("+e.jobName+")":"")})).join(" -> ")}}),methods:{getProcess:function(e){var t=this;this.http("getProcess",{userId:1,deptId:e,processType:2}).then(function(e){t.processData=e})},submitForm:function(e){var t=this;if(!this.hasSetProcess)return this.$msgbox.alert("当前部门还未设置对应报销流程，请联系管理员设置后使用"),!1;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var s=t.form,r=s.targetUserContactQQ,i=s.targetUserContactWx,a=t.form.expenseDept,n=a.deptId,l=a.id;r||i?t.http("applySpreadExpense",xe()({},t.form,{processId:t.processData.id,expenseDept:n||l,project:ut()(t.form.project)})).then(function(){t.$message({message:"申请成功",type:"success"})}):t.$message.error("对接人QQ或微信至少填一项")})},resetForm:function(e){this.$refs[e].resetFields(),this.form.expenseDept=this.userInfo.dept},toSelectDept:function(){this.$refs.selectTree.show()},confirmSelectDept:function(e){0!==e.length&&(this.form.expenseDept=xe()({},e[0]),this.getProcess(e[0].id))}}},Nt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"money-apply"},[e.hasSetProcess||void 0===e.processData.id?e._e():s("div",{staticClass:"px-margin-b20"},[s("el-alert",{attrs:{title:"提示",type:"error",description:"当前部门还未设置对应报销流程，请联系管理员设置后使用",closable:!1}})],1),e._v(" "),s("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"充值金额",prop:"money"}},[s("el-input",{attrs:{type:"number",placeholder:"请输入"},model:{value:e.form.money,callback:function(t){e.$set(e.form,"money",e._n(t))},expression:"form.money"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"平台",prop:"plate"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.plate,callback:function(t){e.$set(e.form,"plate",t)},expression:"form.plate"}},e._l(e.plate,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"账户",prop:"husband"}},[s("el-input",{attrs:{type:"text",placeholder:"请输入卡号"},model:{value:e.form.husband,callback:function(t){e.$set(e.form,"husband",t)},expression:"form.husband"}})],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"对接人",prop:"targetUserName"}},[s("el-input",{attrs:{type:"text",placeholder:"对接人姓名"},model:{value:e.form.targetUserName,callback:function(t){e.$set(e.form,"targetUserName",t)},expression:"form.targetUserName"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:" ",prop:"targetUserMobile"}},[s("el-input",{attrs:{type:"text",placeholder:"对接人手机号"},model:{value:e.form.targetUserMobile,callback:function(t){e.$set(e.form,"targetUserMobile",t)},expression:"form.targetUserMobile"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:" "}},[s("el-input",{attrs:{type:"text",placeholder:"对接人QQ"},model:{value:e.form.targetUserContactQQ,callback:function(t){e.$set(e.form,"targetUserContactQQ",t)},expression:"form.targetUserContactQQ"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:" "}},[s("el-input",{attrs:{type:"text",placeholder:"对接人微信"},model:{value:e.form.targetUserContactWx,callback:function(t){e.$set(e.form,"targetUserContactWx",t)},expression:"form.targetUserContactWx"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:" ",prop:"targetUserMobile"}},[s("el-input",{attrs:{type:"text",placeholder:"对接人公司名称"},model:{value:e.form.targetUserCompany,callback:function(t){e.$set(e.form,"targetUserCompany",t)},expression:"form.targetUserCompany"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"返点",prop:"point"}},[s("el-input",{attrs:{type:"text",placeholder:"请输入"},model:{value:e.form.point,callback:function(t){e.$set(e.form,"point",t)},expression:"form.point"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"项目",prop:"project"}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.form.project,callback:function(t){e.$set(e.form,"project",t)},expression:"form.project"}},e._l(e.project,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"部门"}},[s("div",{staticClass:"display-ib cursor-p",on:{click:e.toSelectDept}},[e.form.expenseDept?s("span",{staticClass:"color-info"},[e._v(e._s(e.form.expenseDept.name))]):e._e()])]),e._v(" "),s("el-form-item",{attrs:{label:"退款金额"}},[s("el-input",{attrs:{type:"number",placeholder:"请输入"},model:{value:e.form.refund,callback:function(t){e.$set(e.form,"refund",e._n(t))},expression:"form.refund"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"说明",prop:"desc"}},[s("el-input",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),e._v(" "),s("div",{staticClass:"process px-margin-b50"},[s("el-alert",{attrs:{title:"系统已设置报销流程",type:"info",closable:!1,description:e.processStr,"show-icon":""}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"danger"},on:{click:function(t){e.submitForm("form")}}},[e._v("提交申请")]),e._v(" "),s("el-button",{on:{click:function(t){e.resetForm("form")}}},[e._v("重置表单")])],1)],1),e._v(" "),s("select-tree",{ref:"selectTree",attrs:{selectedDept:[],selectedUser:[],selectType:1,isNeedUser:!1,isSingleDept:!0},on:{confirm:e.confirmSelectDept}})],1)},staticRenderFns:[]};var At=s("VU/8")(Et,Nt,!1,function(e){s("+27K")},null,null).exports,Ot={name:"money-system-detail",data:function(){return{detail:null,BX_STATUS:ye.a}},watch:{item:function(e){return e}},filters:{formatPlateForm:function(e){return ye.e.find(function(t){return t.value===Number(e)}).label}},props:["item"],mixins:[Ue.a],created:function(){this.getDetail()},methods:{formatProject:function(e){return ye.f.find(function(t){return t.value===Number(e)}).label},getDetail:function(){var e=this;this.http("getSpreadDetail",{expenseId:this.item.id}).then(function(t){t.items=t.items.map(function(t,s){return xe()({},t,{project:e.formatProject(t.project),date:e.$utils.formatTime(t.date),index:s+1})}),t.statusText=ye.a.find(function(e){return Number(e.value)===Number(t.status)}).label,t.project=t.project.map(function(e){return ye.f.find(function(t){return t.value===Number(e)}).label}).join("、"),t.process=t.process.map(function(e){var t=ye.a.find(function(t){return Number(t.value)===Number(e.status)});return xe()({},e,{processIcon:t.icon,processColor:t.color,processText:t.label})}),e.detail=t})}}},Mt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.detail?s("div",{staticClass:"expense-detail"},[s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("报销状态：")]),e._v(" "),s("span",{staticClass:"color-warning"},[e._v(e._s(e.detail.statusText))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("说明：")]),e._v(" "),s("span",[e._v(e._s(e.detail.desc)+" ")])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("平台：")]),e._v(" "),s("span",[e._v(e._s(e._f("formatPlateForm")(e.detail.plantform)))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("充值金额：")]),e._v(" "),s("span",[e._v(e._s(e.detail.money)+"元")])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("项目：")]),e._v(" "),s("span",[e._v(e._s(e.detail.project))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("对接人：")]),e._v(" "),s("span",[e._v(e._s(e.detail.contName))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("对接人手机号：")]),e._v(" "),s("span",[e._v(e._s(e.detail.phone))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("对接人微信：")]),e._v(" "),s("span",[e._v(e._s(e.detail.wx))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("对接人qq：")]),e._v(" "),s("span",[e._v(e._s(e.detail.qq))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("对接人公司：")]),e._v(" "),s("span",[e._v(e._s(e.detail.company))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("报销部门：")]),e._v(" "),s("span",[e._v(e._s(e.detail.label))])]),e._v(" "),s("div",{staticClass:"detail-item"},[s("span",{staticClass:"text-right color-c999"},[e._v("报销时间：")]),e._v(" "),s("span",[e._v(e._s(e.$utils.formatTime(e.detail.createTime)))])]),e._v(" "),s("p",{staticClass:"px-margin-t20"},[e._v("申报明细")]),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.detail.items}},[s("el-table-column",{attrs:{prop:"index",label:"序号",width:"50"}}),e._v(" "),s("el-table-column",{attrs:{prop:"date",label:"日期",width:"140"}}),e._v(" "),s("el-table-column",{attrs:{prop:"money",label:"消费金额",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"project",label:"项目",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"desc",label:"说明"}}),e._v(" "),s("el-table-column",{attrs:{label:"截图"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.images,function(t,r){return s("a",{staticClass:"ib-middle px-margin-r5",attrs:{href:t.url,target:"_blank"}},[e._v("截图"+e._s(r+1))])})}}])})],1),e._v(" "),0===e.detail.items.length?[s("p",{staticClass:"px-margin-t20"},[e._v("报销流程")]),e._v(" "),s("div",{staticClass:"process__wrap position-r"},[e._l(e.detail.process,function(t){return s("div",{staticClass:"process__item position-r"},[s("p",{class:"process__state "+t.processColor},[s("span",{staticClass:"ib-middle px-margin-r5"},[e._v(e._s(t.name)),t.job?s("span",[e._v("("+e._s(t.job)+")")]):e._e()])]),e._v(" "),s("div",{staticClass:"process__info text-right bg-f2 cl"},[s("span",{class:"fl "+t.processColor},[e._v(e._s(t.processText))]),e._v(" "),s("span",{staticClass:"color-c999"},[e._v(e._s(e.$utils.formatTime(t.time)))]),e._v(" "),t.desc?s("p",{staticClass:"text-left"},[s("span",{staticClass:"color-c999"},[e._v("意见：")]),e._v(" "),s("span",[e._v(e._s(t.desc))])]):e._e()]),e._v(" "),s("div",{staticClass:"position-a process__item-icon"},[s("i",{class:t.processIcon+" "+t.processColor})])])}),e._v(" "),s("div",{staticClass:"process_line position-a"})],2)]:e._e()],2):e._e()},staticRenderFns:[]};var Lt=s("VU/8")(Ot,Mt,!1,function(e){s("AAlG")},null,null).exports,Ft={data:function(){return{project:ye.f,form:[],spreadUploadUrl:(this.$utils.dev?"http://oa.ixunle.com":"")+"/service/logic/controller/IndexController.php?act=upload&met=spreadCred"}},created:function(){this.addDetail()},methods:{handleRemove:function(e,t,s){var r=this.form[e].imagesList.findIndex(function(e){return e.iid||e.uid===t.iid||t.uid});this.form[e].imagesList.splice(r,1)},handlePreview:function(e,t){window.open(t.url)},handleSuccess:function(e,t,s){this.form[e].imagesList.push(t.data)},addDetail:function(){this.form.push({date:"",money:"",project:1,imagesList:[],desc:""})},confirm:function(){for(var e=0;e<this.form.length;e++){var t=this.form[e];if(!t.date)return void this.$message.error("请选择日期");if(!t.money)return void this.$message.error("请输入消费金额");if(!t.desc)return void this.$message.error("请输入说明")}this.$emit("confirm",this.form.map(function(e){return xe()({},e,{date:e.date.getTime(),imagesList:e.imagesList.map(function(e){return e.iid})})}))}}},Bt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"add-detail-list"},[e._l(e.form,function(t,r){return[s("p",{staticClass:"px-font-12 color-c999 bg-f2 px-line-40 px-padding-lr10 px-margin-b10"},[e._v("\n      明细("+e._s(r+1)+")\n      "),r>0?s("span",{staticClass:"color-error fr cursor-p",on:{click:function(t){e.form.splice(r,1)}}},[e._v("删除明细")]):e._e()]),e._v(" "),s("el-form",{ref:"form-"+r,refInFor:!0,attrs:{model:t,"label-width":"80px"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"日期"}},[s("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.date,callback:function(s){e.$set(t,"date",s)},expression:"item.date"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"消费金额"}},[s("el-input",{attrs:{type:"number"},model:{value:t.money,callback:function(s){e.$set(t,"money",e._n(s))},expression:"item.money"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"项目"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.project,callback:function(s){e.$set(t,"project",s)},expression:"item.project"}},e._l(e.project,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"说明"}},[s("el-input",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.desc,callback:function(s){e.$set(t,"desc",s)},expression:"item.desc"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"图片"}},[s("el-upload",{staticClass:"upload-demo",attrs:{action:e.spreadUploadUrl,"on-preview":e.handlePreview.bind(this,r),"on-remove":e.handleRemove.bind(this,r),"on-success":e.handleSuccess.bind(this,r),"file-list":t.imagesList,"list-type":"picture"}},[s("el-button",{attrs:{size:"small",type:"danger"}},[e._v("点击上传")]),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("tips: 1-9张，只能上传jpg/png文件，且不超过500kb")])],1)],1)],1)]}),e._v(" "),s("div",{staticClass:"text-right"},[s("el-button",{attrs:{type:"danger"},on:{click:e.addDetail}},[e._v("添加明细")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认添加")])],1)],2)},staticRenderFns:[]},Rt=s("VU/8")(Ft,Bt,!1,null,null,null).exports,zt={name:"money-system-list",data:function(){return{payType:ye.b,tableWrapHeight:this.wrapHeight-110,currentPage:1,dialogVisible:!1,dialogDetailVisible:!1,currentChooseItem:null,listData:[],bxStatus:ye.a,listType:0,listPayType:[],listTime:[],listKeyword:"",listBxStatus:"",listBxDept:[],listBxUser:[]}},created:function(){},mixins:[Ue.a],watch:{wrapHeight:function(e){return this.tableWrapHeight=e-110,e},activeName:function(e){return this.reset(),"fourth"!==e&&this.getExpenseList(),e}},mounted:function(){this.isTotal||this.getExpenseList()},methods:{summaryMethod:function(e){var t=e.columns,s=e.data;console.log(t,s)},beforeClose:function(e){this.$msgbox.confirm("确认关闭吗？").then(function(){e()})},beforeClose2:function(e){this.currentChooseItem=null,e()},confirmSearch:function(){this.reset(),this.getExpenseList()},resetSearch:function(){this.reset(),this.listType=0,this.listPayType=[],this.listTime=[],this.listKeyword="",this.listBxStatus="",this.listBxDept=[],this.listBxUser=[]},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e)},confirmSelectTree:function(e,t){this.listBxDept=e,this.listBxUser=t},reset:function(){this.listData=[],this.currentChooseItem=null,this.currentPage=1},getExpenseList:function(){var e=this,t=[],s=[],r=[];this.listTime.length>0&&(t=[this.listTime[0].getTime(),this.listTime[1].getTime()]),this.listBxDept.length>0&&(s=this.listBxDept.map(function(e){return e.id})),this.listBxUser.length>0&&(r=this.listBxUser.map(function(e){return e.userId})),this.http("getSpreadExpenseList",{currentPage:1,pageSize:10,listType:this.isFromMe?1:this.isToMe?2:3,payType:ut()(this.listPayType),createTimeBetween:ut()(t),expenseDept:ut()(s),expenseUserId:ut()(r),keyword:this.listKeyword,expenseStatus:this.listBxStatus}).then(function(t){e.listData=(t.list||[]).map(function(t){return xe()({},t,{createTime:e.$utils.formatTime(t.createTime),plantform:ye.e.find(function(e){return e.value===Number(t.plantform)}).label+",",aphone:t.aphone?t.aphone+",":"",point:t.point+"%",project:t.project instanceof Array?t.project.map(function(e){return ye.f.find(function(t){return t.value===Number(e)}).label}).join("/"):"",statusText:ye.a.find(function(e){return Number(e.value)===Number(t.status)}).label})})})},doOption:function(e,t){var s=this;switch(t&&(this.currentChooseItem=t),e){case-1:this.dialogDetailVisible=!0;break;case 0:this.dialogVisible=!0;break;case 1:this.$msgbox.prompt("请输入同意意见(非必填)").then(function(e){r.call(s,{status:3,message:e.value})});break;case 2:this.$msgbox.prompt("请输入拒绝意见(必填)").then(function(e){e.value?r.call(s,{status:4,message:e.value}):s.$message.error("请输入意见")});break;case 3:this.$msgbox.confirm("确定要撤回吗？").then(function(){r.call(s,{status:8})});break;case 4:this.$msgbox.confirm("即将打款金额为"+t.money+"元给"+t.name+"，确定要继续吗？").then(function(){r.call(s,{status:6})});break;case 5:this.$msgbox.confirm("确定要撤销打款吗？")}function r(e){var t=this;this.http("handleSpreadStatus",xe()({},e,{expenseId:this.currentChooseItem.id})).then(function(){var s=3===e.status?"同意":4===e.status?"拒绝":3===e.status?"撤回":"打款";t.$message.success(s+"成功"),t.dialogVisible=!1})}},addDetail:function(e){var t=this;this.http("addSpreadExpenseDetail",{expenseId:this.currentChooseItem.id,items:ut()(e)}).then(function(){t.$message.success("添加明细成功"),t.dialogDetailVisible=!1})}},props:{activeName:String,wrapHeight:{type:Number,default:0}},computed:{isFromMe:function(){return"second"===this.activeName},isToMe:function(){return"third"===this.activeName},isTotal:function(){return"fourth"===this.activeName},isCaiWu:function(){return!0}},components:{Detail:Lt,AddDetailList:Rt}},qt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"list"},[s("div",{staticClass:"position-f px-left-10 px-right-10 px-top-60 px-bottom-50 overflow-a"},[e.isTotal?s("div",[s("div",{staticClass:"search__wrap search__wrap-dept ib-middle"},[s("span",{staticClass:"ib-middle"},[e._v("报销部门或人")]),e._v(" "),s("div",{staticClass:"ib-middle dept",on:{click:function(t){e.$refs.selectTree.show()}}},[s("span",{staticClass:"color-info"},[e._v("请选择")])])]),e._v(" "),s("div",{staticClass:"search__wrap ib-middle"},[s("span",{staticClass:"ib-middle"},[e._v("支出类别")]),e._v(" "),s("div",{staticClass:"ib-middle"},[s("el-cascader",{attrs:{"expand-trigger":"hover",options:e.payType,filterable:"","change-on-select":""},model:{value:e.listPayType,callback:function(t){e.listPayType=t},expression:"listPayType"}})],1)]),e._v(" "),s("div",{staticClass:"search__wrap ib-middle"},[s("span",{staticClass:"ib-middle"},[e._v("审批状态")]),e._v(" "),s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.listBxStatus,callback:function(t){e.listBxStatus=t},expression:"listBxStatus"}},e._l(e.bxStatus,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),s("br"),e._v(" "),s("div",{staticClass:"search__wrap search__wrap-date ib-middle"},[s("span",{staticClass:"ib-middle px-width-90"},[e._v("报销发起时间")]),e._v(" "),s("div",{staticClass:"ib-middle"},[s("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.listTime,callback:function(t){e.listTime=t},expression:"listTime"}})],1)]),e._v(" "),s("div",{staticClass:"search__wrap ib-middle"},[s("span",{staticClass:"ib-middle"},[e._v("关键字")]),e._v(" "),s("div",{staticClass:"ib-middle"},[s("el-input",{attrs:{placeholder:"请输入"},model:{value:e.listKeyword,callback:function(t){e.listKeyword=t},expression:"listKeyword"}})],1)]),e._v(" "),s("div",{staticClass:"ib-middle px-margin-b15"},[s("el-button",{attrs:{type:"danger"},on:{click:e.confirmSearch}},[e._v("搜索查询")])],1),e._v(" "),s("div",{staticClass:"ib-middle px-margin-b15"},[s("el-button",{on:{click:e.resetSearch}},[e._v("重置")])],1)]):e._e(),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.listData,"show-summary":"",height:e.tableWrapHeight}},[s("el-table-column",{attrs:{prop:"no",label:"工号",sortable:"",width:"130"}}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"报销时间",width:"130"}}),e._v(" "),s("el-table-column",{attrs:{prop:"money",label:"充值金额",sortable:"",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"plantform",label:"平台",sortable:"",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{prop:"account",label:"账户",width:"150"}}),e._v(" "),s("el-table-column",{attrs:{prop:"project",label:"项目",sortable:"",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"aname",label:"对接人",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{prop:"aphone",label:"对接人电话",width:"110"}}),e._v(" "),s("el-table-column",{attrs:{prop:"dept",label:"报销部门",width:"80"}}),e._v(" "),e.isToMe?s("el-table-column",{attrs:{prop:"name",label:"报销人",width:"80"}}):e._e(),e._v(" "),s("el-table-column",{attrs:{prop:"point",label:"返点",width:"60"}}),e._v(" "),s("el-table-column",{attrs:{prop:"desc",label:"说明"}}),e._v(" "),s("el-table-column",{attrs:{prop:"statusText",label:"状态",sortable:"",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:120},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){e.doOption(0,t.row)}}},[e._v("查看")]),e._v(" "),e.isFromMe?[1===t.row.rstatus?s("a",{staticClass:"color-error",attrs:{href:"javascript:"},on:{click:function(s){e.doOption(3,t.row)}}},[e._v("撤回")]):3===t.row.rstatus?s("a",{staticClass:"color-info",attrs:{href:"javascript:"},on:{click:function(s){e.doOption(-1,t.row)}}},[e._v("添加明细")]):e._e()]:e.isToMe?[5===t.row.rstatus?s("a",{staticClass:"color-success",attrs:{href:"javascript:"},on:{click:function(s){e.doOption(4,t.row)}}},[e._v("打款")]):e._e(),e._v(" "),1===t.row.rstatus?[s("a",{staticClass:"color-success",attrs:{href:"javascript:"},on:{click:function(s){e.doOption(1,t.row)}}},[e._v("同意")]),e._v(" "),s("a",{staticClass:"color-error",attrs:{href:"javascript:"},on:{click:function(s){e.doOption(2,t.row)}}},[e._v("拒绝")])]:e._e()]:e._e()]}}])})],1)],1),e._v(" "),s("div",{staticClass:"position-f px-bottom-10 width-100 text-center"},[s("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[20,30,40,50,100],"page-size":20,background:"",layout:"prev, pager, next, sizes, jumper",total:e.listData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1),e._v(" "),s("el-dialog",{attrs:{title:"报销详情",visible:e.dialogVisible,"append-to-body":!0,top:"10px",width:"650px","before-close":e.beforeClose2},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.currentChooseItem?[s("detail",{attrs:{item:e.currentChooseItem}}),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isFromMe?[1===e.currentChooseItem.rstatus?s("a",{staticClass:"color-error",attrs:{href:"javascript:"},on:{click:function(t){e.doOption(3)}}},[e._v("撤回")]):3===e.currentChooseItem.rstatus?s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.doOption(-1)}}},[e._v("添加明细")]):e._e()]:e.isToMe?[1===e.currentChooseItem.rstatus?[s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){e.doOption(1)}}},[e._v("同 意")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){e.doOption(2)}}},[e._v("拒 绝")])]:5===e.currentChooseItem.rstatus?s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.doOption(4)}}},[e._v("打 款")]):e._e()]:e._e()],2)]:e._e()],2),e._v(" "),s("el-dialog",{attrs:{title:"添加申报明细",visible:e.dialogDetailVisible,"append-to-body":!0,top:"100px",width:"650px","before-close":e.beforeClose},on:{"update:visible":function(t){e.dialogDetailVisible=t}}},[e.currentChooseItem?s("add-detail-list",{on:{confirm:e.addDetail}}):e._e()],1),e._v(" "),s("select-tree",{ref:"selectTree",attrs:{selectedDept:e.listBxDept,selectedUser:e.listBxUser},on:{confirm:e.confirmSelectTree}})],1)},staticRenderFns:[]};var Vt=s("VU/8")(zt,qt,!1,function(e){s("Nnkr")},null,null).exports,Jt={name:"spread-expense",mixins:[Ue.a],data:function(){return{activeName:"first",wrapHeight:0}},created:function(){},mounted:function(){this.wrapHeight=this.$refs.expense.getBoundingClientRect().height},computed:xe()({},Object(Ce.e)(["userInfo"]),Object(Ce.c)(["otherPriv"])),components:{MoneySystemApply:At,MoneySystemList:Vt},methods:{handleClick:function(e,t){}}},Wt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"expense",staticClass:"expense width-100 height-100 bg-fff overflow-a"},[s("div",{staticClass:"px-padding-10"},[s("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{name:"first"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-edit"}),e._v(" 填写申请")])]),e._v(" "),s("el-tab-pane",{attrs:{name:"second"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-sort-up"}),e._v(" 我发起的")])]),e._v(" "),s("el-tab-pane",{attrs:{name:"third"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-sort-down"}),e._v(" 我收到的")])]),e._v(" "),e.otherPriv.spread?s("el-tab-pane",{attrs:{name:"fourth"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-tickets"}),e._v(" 统计")])]):e._e()],1),e._v(" "),e.userInfo?["first"===e.activeName?s("money-system-apply"):e.wrapHeight?s("money-system-list",{attrs:{"wrap-height":e.wrapHeight,"active-name":e.activeName}}):e._e()]:e._e()],2)])},staticRenderFns:[]};var Kt=s("VU/8")(Jt,Wt,!1,function(e){s("7jEl")},null,null).exports,Ht={data:function(){return{currentView:""}},mixins:[Ue.a],created:function(){var e=this.$route.query.menuId;this.menuChange(e?Number(e):0),this.getUserInfo()},computed:xe()({},Object(Ce.e)(["currMenuId","userInfo"])),watch:{userInfo:function(e){if(e){var t=this.$route.query.menuId;this.menuChange(t?Number(t):0)}return e}},methods:xe()({},Object(Ce.d)(["setState"]),{menuChange:function(e){if(this.userInfo&&this.userInfo.menuPriv.includes(e)){var t=ye.h.find(function(t){return t.id===e});this.currentView=t.componentName}else this.currentView="Home"},getUserInfo:function(){var e=this;this.userInfo||this.http("getInfos").then(function(t){t.menuPriv=t.menuPriv.map(function(e){return Number(e)}),t.contactPriv=t.contactPriv.map(function(e){return Number(e)}),e.setState({key:"userInfo",value:t})})}}),components:{CommonFrame:Se,Home:Ee,Annous:Fe,DeptUser:ot,Priv:mt,MoneySystem:jt,Job:ht,SpreadExpense:Kt}},Qt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("common-frame",{on:{menuChange:this.menuChange}},[t(this.currentView,{tag:"component"})],1)},staticRenderFns:[]},Zt=s("VU/8")(Ht,Qt,!1,null,null,null).exports,Yt=s("fZjL"),Gt=s.n(Yt),Xt={data:function(){return{form:{name:"",pwd:""},rules:{name:[{required:!0,message:"请输入帐号",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}]}}},mixins:[Ue.a],mounted:function(){},methods:xe()({},Object(Ce.d)(["setState"]),{submitForm:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form";this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.http("login",xe()({},e.form,{pwd:Te()(e.form.pwd)})).then(function(t){Gt()(t).forEach(function(e){De.a.set(e,t[e],{expires:1})}),e.$router.push("/")})})},resetForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form";this.$refs[e].resetFields()}})},es={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"position-f width-100 top-0 bottom-0 login-container"},[r("div",{staticClass:"position-a login-wrap bd-ccc px-padding-20 radius-3"},[r("p",{staticClass:"px-font-20 text-center px-padding-b20"},[r("img",{staticClass:"px-padding-tb10",attrs:{src:s("7Otq"),width:"150px"}})]),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"0px"}},[r("el-form-item",{attrs:{label:"",prop:"name"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入用户名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"",prop:"pwd"}},[r("el-input",{attrs:{type:"password",clearable:"",placeholder:"请输入密码"},model:{value:e.form.pwd,callback:function(t){e.$set(e.form,"pwd",t)},expression:"form.pwd"}})],1),e._v(" "),r("el-form-item",{staticClass:"text-center"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm()}}},[e._v("登陆")]),e._v(" "),r("el-button",{on:{click:function(t){e.resetForm()}}},[e._v("重置")])],1)],1),e._v(" "),r("p",{staticClass:"color-c666 px-font-12 text-center"},[e._v("\n      © 相源科技 版权所有\n    ")])],1)])},staticRenderFns:[]};var ts=s("VU/8")(Xt,es,!1,function(e){s("yV5M")},"data-v-08662960",null).exports;ve.default.use(be.a);var ss=new be.a({routes:[{path:"/",name:"index",component:Zt,meta:{auth:!0,title:"管理系统"}},{path:"/login",name:"login",component:ts,meta:{auth:!1,title:"登录管理系统"}}]});ss.beforeEach(function(e,t,s){e.matched.some(function(e){return e.meta.auth})&&!De.a.get("_token")?s("/login"):s()}),ss.afterEach(function(e,t){document.title=e.meta.title});var rs=ss;ve.default.use(Ce.a);var is=new Ce.a.Store({state:{currMenuId:0,userTableHeight:0,dept:null,userMap:{},currentDept:null,currentUser:null,currentUserDeptId:0,handleType:"",userInfo:null,isSuperAdmin:!1},getters:{userList:function(e){return(e.userMap[e.currentUserDeptId]||[]).map(function(e){return xe()({},e,{joinDateF:ve.default.prototype.$utils.formatTime(e.joinDate),transferDateF:ve.default.prototype.$utils.formatTime(e.transferDate),leaveDateF:ve.default.prototype.$utils.formatTime(e.leaveDate),birthdayF:ve.default.prototype.$utils.formatTime(e.birthday)})})},contactPriv:function(e){var t=!1,s=!1,r=!1;if(e.userInfo){var i=e.userInfo.contactPriv;t=i.includes(0),s=i.includes(1),r=i.includes(2)}return{user:t,dept:s,imp:r}},otherPriv:function(e){var t=!1,s=!1,r=!1,i=!1,a=!1;if(e.userInfo){var n=e.userInfo.contactPriv;t=n.includes(3),s=n.includes(4),r=n.includes(5),i=n.includes(6),a=n.includes(7)}return{process:t,annous:s,job:r,expense:i,spread:a}}},mutations:{clear:function(e){e.userMap={},e.userInfo=null,e.isSuperAdmin=!1},setState:function(e,t){"array"===t.key?Gt()(t.value).forEach(function(s){e[s]=t.value[s]}):e[t.key]=t.value}},actions:{getUserById:function(e,t){var s=e.state,r=(e.commit,void 0!==t.deptId?t.deptId:t),i=t.callback,a=s.userMap[r];if(s.currentUserDeptId=r,a)return i&&i(a),a;Ne.a.getUserByDeptId({deptId:r}).then(function(e){e.data&&(ve.default.set(s.userMap,r,e.data),i&&i(e.data))})}}}),as={name:"select-tree",mixins:[ze],data:function(){return{dialogFormVisible:!1,defaultProps:{children:"children",label:"label"},selectDeptArr:[],selectUserArr:[],currentSelectDeptUser:[]}},watch:{dialogFormVisible:function(e){return e&&this.initCheck(),e}},created:function(){},methods:xe()({},Object(Ce.b)(["getUserById"]),Object(Ce.d)(["setState"]),{initCheck:function(){this.selectUserArr=this.selectedUser.slice(),this.selectDeptArr=this.selectedDept.slice()},checkDefaultUser:function(e){var t=this;this.currentSelectDeptUser=e,this.$nextTick(function(){var s=void 0;t.selectUserArr.forEach(function(r){e.some(function(e){return e.id===r.id})&&(s=t.userList.find(function(e){return e.id===r.id}),t.$refs.multipleTable.toggleRowSelection(s,!0))})})},checkDefaultDept:function(){var e=this;this.$nextTick(function(){e.selectDeptArr.forEach(function(t){return e.$refs.tree.setChecked(t.id,!0,!1)})})},getDeptCallback:function(e){var t=this;this.$nextTick(function(){t.$refs.tree.setCurrentKey(e[0].id)}),this.isNeedDept&&this.checkDefaultDept(),this.isNeedUser&&this.getUserById({deptId:e[0].id,callback:this.checkDefaultUser.bind(this)})},handleClickDept:function(e){e.id!==this.currentDept.id&&(this.isNeedDept&&this.checkDefaultDept(),this.isNeedUser&&this.getUserById({deptId:e.id,callback:this.checkDefaultUser.bind(this)}))},handleSelectDept:function(e,t){var s=this;t?(this.isSingleDept&&this.$refs.tree.getCheckedKeys().forEach(function(t){e.id!==t&&s.$refs.tree.setChecked(t,!1,!0)}),-1===this.selectDeptArr.findIndex(function(t){return t.id===e.id})&&this.selectDeptArr.push(xe()({},e,{children:null}))):this.selectDeptArr.splice(this.selectDeptArr.findIndex(function(t){return t.id===e.id}),1)},delDeptSelect:function(e){var t=this.$refs.tree;null===e?t.getCheckedKeys().forEach(function(e){return t.setChecked(e,!1,!0)}):t.setChecked(e.id,!1,!0)},delUserSelect:function(e,t){var s=this;e instanceof Array?e.forEach(function(e){return s.$refs.multipleTable.toggleRowSelection(e,!1)}):(this.$refs.multipleTable.toggleRowSelection(e,!1),this.selectUserArr.splice(t,1))},handleSelectUser:function(e,t){var s=this;if(Boolean(e.find(function(e){return e.id===t.id})))this.selectUserArr=this.selectUserArr.concat(e.filter(function(e){return s.selectUserArr.every(function(t){return e.id!==t.id})}));else{var r=this.selectUserArr.findIndex(function(e){return e.id===t.id});this.selectUserArr.splice(r,1)}},handleSelectUserAll:function(e){var t=this;e.length>0?this.selectUserArr=this.selectUserArr.concat(e.filter(function(e){return t.selectUserArr.every(function(t){return e.id!==t.id})})):this.selectUserArr=this.selectUserArr.map(function(e){return t.currentSelectDeptUser.some(function(t){return t.id===e.id})?null:e}).filter(function(e){return e})},reset:function(){this.delDeptSelect(null),this.isNeedUser&&this.$refs.multipleTable.clearSelection(),this.selectDeptArr=[],this.selectUserArr=[],this.dialogFormVisible=!1},show:function(){this.dialogFormVisible=!0,this.initDept()},confirm:function(){this.$emit("confirm",this.selectDeptArr.map(function(e){return e.name=e.label.replace(" ("+e.userNum+")",""),e}),this.selectUserArr),this.reset(),this.dialogFormVisible=!1},clear:function(){this.delDeptSelect(null),this.delUserSelect(this.selectUserArr),this.selectUserArr=[]}}),computed:xe()({},Object(Ce.e)(["dept"]),Object(Ce.c)(["userList"]),{isNeedDept:function(){return 2!==this.selectType}}),props:{title:{type:String,default:"选择部门或人员"},width:{type:String,default:"600px"},selectType:{type:Number,default:0},selectedDept:{type:Array,default:function(){return[]}},selectedUser:{type:Array,default:function(){return[]}},modal:{type:Boolean,default:!0},isSingleDept:{type:Boolean,default:!1}}},ns={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"select-tree"},[s("el-dialog",{attrs:{width:e.width,title:e.title,"show-close":!1,"close-on-click-modal":!1,"append-to-body":!0,modal:e.modal,top:"10vh",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("div",{staticClass:"select-tree__dept ib-middle"},[e.dialogFormVisible?s("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{"node-key":"id",data:e.dept,props:e.defaultProps,"show-checkbox":e.isNeedDept,"default-expanded-keys":["1"],"highlight-current":!0,"expand-on-click-node":!1,"check-strictly":!0},on:{"node-click":e.handleClickDept,"check-change":e.handleSelectDept}}):e._e()],1),e._v(" "),e.isNeedUser?s("div",{staticClass:"select-tree__user overflow-a bd-gray-lighter-l ib-middle"},[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.userList,"tooltip-effect":"dark"},on:{select:e.handleSelectUser,"select-all":e.handleSelectUserAll}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"姓名",width:"100","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"mobile",label:"手机号"}})],1)],1):e._e(),e._v(" "),s("div",{staticClass:"select-tree__selected overflow-a bd-gray-lighter-t px-font-12"},[s("p",[s("span",{staticClass:"color-c999"},[e._v("已选择")]),e._v(" "),s("span",{staticClass:"cursor-p color-info",on:{click:e.clear}},[e._v("清空已选择")])]),e._v(" "),e._l(e.selectDeptArr,function(t,r){return s("div",{key:"dept-"+t.id,staticClass:"select-tree__tag"},[s("span",{staticClass:"over-text ib-middle"},[e._v(e._s(e._f("getLabel")(t)))]),e._v(" "),s("i",{staticClass:"el-icon-close ib-middle",on:{click:function(s){e.delDeptSelect(t,r)}}})])}),e._v(" "),e._l(e.selectUserArr,function(t,r){return s("div",{key:t.departmentId+"-user-"+t.id,staticClass:"select-tree__tag"},[s("span",{staticClass:"over-text ib-middle"},[e._v(e._s(t.name))]),e._v(" "),s("i",{staticClass:"el-icon-close ib-middle",on:{click:function(s){e.delUserSelect(t,r)}}})])})],2),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.reset()}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定选择")])],1)])],1)},staticRenderFns:[]};var ls=s("VU/8")(as,ns,!1,function(e){s("xACJ")},null,null).exports,os={formatTime:function(e){if(!e)return e;var t=new Date(Number(e));return t.getFullYear()+"/"+s(t.getMonth()+1)+"/"+s(t.getDate());function s(e){return e>9?e:"0"+e}},dev:"production"!==Object({NODE_ENV:"production"})};ve.default.config.productionTip=!1,ve.default.use(fe.a),ve.default.use(de.a),ve.default.use(ue.a),ve.default.use(oe.a),ve.default.use(ne.a),ve.default.use(ie.a),ve.default.use(se.a),ve.default.use(ee.a),ve.default.use(G.a),ve.default.use(Z.a),ve.default.use(H.a),ve.default.use(W.a),ve.default.use(V.a),ve.default.use(z.a),ve.default.use(B.a),ve.default.use(L.a),ve.default.use(O.a),ve.default.use(N.a),ve.default.use(j.a),ve.default.use(S.a),ve.default.use(I.a),ve.default.use(T.a),ve.default.use(D.a),ve.default.use(y.a),ve.default.use(x.a),ve.default.use(b.a),ve.default.use(h.a),ve.default.use(f.a),ve.default.use(d.a),ve.default.use(u.a.directive),ve.default.prototype.$loading=u.a.service,ve.default.prototype.$msgbox=o.a,ve.default.prototype.$alert=o.a.alert,ve.default.prototype.$confirm=o.a.confirm,ve.default.prototype.$prompt=o.a.prompt,ve.default.prototype.$notify=n.a,ve.default.prototype.$message=i.a,ve.default.prototype.$utils=os,ve.default.component(ls.name,ls),new ve.default({el:"#app",router:rs,store:is,components:{App:_e},template:"<App/>"})},Ni4G:function(e,t){},Nnkr:function(e,t){},P8CB:function(e,t){},Q6SQ:function(e,t){},Rh7U:function(e,t){},TFIm:function(e,t){},WzZF:function(e,t){},"X+ky":function(e,t){},XPMo:function(e,t){},Yq4J:function(e,t){},Zki6:function(e,t){},bFZ2:function(e,t){},cDSy:function(e,t){},cwe7:function(e,t){},d7TW:function(e,t){},dWxa:function(e,t){},dmRH:function(e,t){},isE6:function(e,t){},isgN:function(e,t){},jAzQ:function(e,t){},jZDA:function(e,t){},m2a4:function(e,t){},oIBD:function(e,t){},oQIp:function(e,t){},oq7i:function(e,t){},qunJ:function(e,t){},rD0i:function(e,t){},rg67:function(e,t){},s967:function(e,t){},sRqJ:function(e,t){},uFqb:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__=__webpack_require__("Gu7T"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends__=__webpack_require__("Dd8w"),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_3__mixins_http__=__webpack_require__("4aj8"),__WEBPACK_IMPORTED_MODULE_4_vuex__=__webpack_require__("NYxO"),__WEBPACK_IMPORTED_MODULE_5__constant__=__webpack_require__("HR9g");__webpack_exports__.a={name:"money-system-setting",created:function(){this.getSetting()},data:function(){return{setting:{process:null},processType:__WEBPACK_IMPORTED_MODULE_5__constant__.d,form:{processName:"",target:{dept:[],user:[]},process:[],processType:1},rules:{processName:[{required:!0,message:"请流程名称",trigger:"blur"},{min:2,max:100,message:"长度在 2 到 100 个字符",trigger:"blur"}],target:[{required:!0,message:"请选择流程管理范围"}],process:[{required:!0,message:"请选择流程节点"}]},isNewProcess:!1,editProcessId:null,currentSelect:"",selectedDept:[],selectedUser:[],selectType:0}},mixins:[__WEBPACK_IMPORTED_MODULE_3__mixins_http__.a],watch:{isActive:function(e){return e&&this.getSetting(),e}},computed:__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends___default()({},Object(__WEBPACK_IMPORTED_MODULE_4_vuex__.e)(["userInfo"])),methods:{getSetting:function(){var e=this;this.http("getSetting",{userId:this.userInfo.userId,deptId:this.userInfo.dept.id}).then(function(t){e.setting.process=t.processList})},toMessage:function toMessage(type){var msg1="流程环节是指：流程从A到B再到C等等的节点，此处点击按顺序添加即是流程的顺序。",msg2="流程管理范围是指：这条流程对哪些人或部门生效，人的优先级要高于部门。例如：A在技术部，对技术部设置了x流程，对A又设置了y流程，此时对A来说生效的是y流程。";this.$msgbox.alert(eval(""+type))},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;if(0===t.form.target.dept.length&&0===t.form.target.user.length)t.$msgbox.alert("请选择流程管理范围");else{var s=t.form.target.dept.map(function(e){return e.id}),r=t.form.target.user.map(function(e){return e.userId}),i=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends___default()({},t.form,{target:__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify___default()({dept:s,user:r}),process:__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify___default()(t.form.process.map(function(e){return e.userId}))});t.editProcessId&&(i.id=t.editProcessId),t.http("addProcess",i).then(function(){t.$message.success(i.id?"编辑成功":"添加成功")})}})},toSelect:function(e){this.currentSelect=e,"processRange"===e?(this.selectedDept=this.form.target.dept,this.selectedUser=this.form.target.user,this.selectType=0):(this.selectedDept=[],this.selectedUser=this.form.process,this.selectType=2),this.$refs.selectTree.show()},confirmSelectDept:function(e,t){"processRange"===this.currentSelect?(this.form.target.dept=e,this.form.target.user=t):this.form.process=t},delProcess:function(e){var t=this;this.$msgbox.confirm("确定要删除该条流程吗？").then(function(){t.http("delProcess",{id:e.id}).then(function(){t.$message.success("删除成功")})})},newProcess:function(){this.editProcessId=null,this.isNewProcess=!0,this.clear(1),this.clear(2)},editProcess:function(e){this.editProcessId=e.id,this.form.processName=e.processName,this.form.target=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_extends___default()({},e.target),this.form.process=[].concat(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default()(e.process)),this.isNewProcess=!0},clear:function(e){1===e?this.form.process=[]:this.form.target={dept:[],user:[]}}},props:{isActive:!1}}},xACJ:function(e,t){},yV5M:function(e,t){},ylbK:function(e,t){},ylrw:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.bf7c473c77bc8802d795.js.map